[0m23:20:20.868127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ef274860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ee841ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ef0ce3c0>]}


============================== 23:20:20.885054 | 3a701e81-f47e-46fc-ad75-b6785d61ccc5 ==============================
[0m23:20:20.885054 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:20:20.885861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:20:20.890346 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'football_dbt'
[0m23:20:20.893722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.13433157, "process_in_blocks": "90448", "process_kernel_time": 0.900301, "process_mem_max_rss": "85808", "process_out_blocks": "1472", "process_user_time": 1.957861}
[0m23:20:20.894929 [debug] [MainThread]: Command `dbt run` failed at 23:20:20.894669 after 0.14 seconds
[0m23:20:20.895796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8eea06630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ee5be7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ef274860>]}
[0m23:20:20.896830 [debug] [MainThread]: Flushing usage events
[0m23:20:22.359886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:31.963484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d23751eede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d237531e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2376aee420>]}


============================== 23:23:31.975207 | bdbb3cbc-91d9-4442-a7c3-c827f955f93d ==============================
[0m23:23:31.975207 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:23:31.976227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:23:31.979962 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'football_dbt'
[0m23:23:31.982612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08886299, "process_in_blocks": "0", "process_kernel_time": 0.558894, "process_mem_max_rss": "87004", "process_out_blocks": "1472", "process_user_time": 1.927615}
[0m23:23:31.983770 [debug] [MainThread]: Command `dbt run` failed at 23:23:31.983570 after 0.09 seconds
[0m23:23:31.984447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2374f30800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2374c77950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2374c77d10>]}
[0m23:23:31.985179 [debug] [MainThread]: Flushing usage events
[0m23:23:33.810488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:28:48.094008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a85967b2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a85955bd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a85968ec7d0>]}


============================== 23:28:48.106719 | a5de6d7c-74c1-467f-91fc-a9c42e5447e0 ==============================
[0m23:28:48.106719 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:28:48.107514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:28:48.108181 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m23:28:48.110224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09085488, "process_in_blocks": "0", "process_kernel_time": 0.511347, "process_mem_max_rss": "86620", "process_out_blocks": "1480", "process_user_time": 1.904195}
[0m23:28:48.111115 [debug] [MainThread]: Command `dbt run` failed at 23:28:48.110919 after 0.09 seconds
[0m23:28:48.111816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8594b13ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8594e92db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8594e91850>]}
[0m23:28:48.112356 [debug] [MainThread]: Flushing usage events
[0m23:28:49.944672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:17.986721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a834db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a6758440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a6307ad0>]}


============================== 23:30:17.999872 | 7c038bb2-3b3b-46be-912e-d2a795364c0c ==============================
[0m23:30:17.999872 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:30:18.004813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:30:18.480873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c038bb2-3b3b-46be-912e-d2a795364c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a63b6d20>]}
[0m23:30:18.572478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c038bb2-3b3b-46be-912e-d2a795364c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a666cf20>]}
[0m23:30:18.592455 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:30:18.798872 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:30:18.800821 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:30:18.801463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c038bb2-3b3b-46be-912e-d2a795364c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a4a01eb0>]}
[0m23:30:20.341371 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.football_dbt.stg_teams' (models/staging/stg_teams.sql) depends on a source named 'raw.teams' which was not found
[0m23:30:20.343316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.429696, "process_in_blocks": "13208", "process_kernel_time": 0.778877, "process_mem_max_rss": "99052", "process_out_blocks": "1504", "process_user_time": 3.662623}
[0m23:30:20.344210 [debug] [MainThread]: Command `dbt run` failed at 23:30:20.344030 after 2.43 seconds
[0m23:30:20.345026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a6ad63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a7235af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9a48faea0>]}
[0m23:30:20.345561 [debug] [MainThread]: Flushing usage events
[0m23:30:22.152251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:07.410460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca54141e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca52e70ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca5282d4c0>]}


============================== 23:45:07.428785 | 0d2a7860-7ddd-4eda-a1bb-6eefea61c6ba ==============================
[0m23:45:07.428785 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:45:07.429781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:07.842119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d2a7860-7ddd-4eda-a1bb-6eefea61c6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca52376360>]}
[0m23:45:07.942757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d2a7860-7ddd-4eda-a1bb-6eefea61c6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca522769f0>]}
[0m23:45:07.961821 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:45:08.149278 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:45:08.150926 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:45:08.151470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d2a7860-7ddd-4eda-a1bb-6eefea61c6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca52629a90>]}
[0m23:45:09.825957 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/sources/sources.yml @ sources: {'name': 'raw', 'database': 'football_db', 'tables': [{'name': 'competitions', 'columns': [{'name': 'id'}, {'name': 'name'}, {'name': 'code'}, {'name': 'type'}, {'name': 'plan'}, {'name': 'area_id'}, {'name': 'area_name'}, {'name': 'season_id'}, {'name': 'season_start'}, {'name': 'season_end'}, {'name': 'emblem'}, {'name': 'last_updated'}, {'name': 'raw_payload'}, {'name': 'inserted_at'}]}, {'name': 'matches', 'columns': [{'name': 'id'}, {'name': 'date'}, {'name': 'area_id'}, {'name': 'competition_id'}, {'name': 'season_id'}, {'name': 'status'}, {'name': 'duration_status'}, {'name': 'stage'}, {'name': 'group_name'}, {'name': 'home_team'}, {'name': 'away_team'}, {'name': 'score'}, {'name': 'last_updated'}, {'name': 'raw_payload'}, {'name': 'inserted_at'}]}, {'name': 'teams', 'columns': [{'name': 'id'}, {'name': 'comp_id'}, {'name': 'name'}, {'name': 'code'}, {'name': 'flag'}, {'name': 'team_emblem'}, {'name': 'founded'}, {'name': 'venue'}, {'name': 'website'}, {'name': 'club_colors'}, {'name': 'address'}, {'name': 'last_updated'}, {'name': 'raw_payload'}, {'name': 'inserted_at'}]}, {'name': 'players'}], 'columns': [{'name': 'id'}, {'name': 'name'}, {'name': 'date_of_birth'}, {'name': 'nationality'}, {'name': 'position'}, {'name': 'current_team'}, {'name': 'last_updated'}, {'name': 'raw_payload'}, {'name': 'inserted_at'}]} - at path []: Additional properties are not allowed ('columns' was unexpected)
[0m23:45:09.829535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.522039, "process_in_blocks": "104464", "process_kernel_time": 1.004315, "process_mem_max_rss": "98556", "process_out_blocks": "1504", "process_user_time": 3.86275}
[0m23:45:09.830932 [debug] [MainThread]: Command `dbt run` failed at 23:45:09.830638 after 2.52 seconds
[0m23:45:09.832098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca50a4d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca505fbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca50828200>]}
[0m23:45:09.833212 [debug] [MainThread]: Flushing usage events
[0m23:45:11.861599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:35.117908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a75d5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a75d5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a75d40b0>]}


============================== 23:49:35.133924 | 39da82b3-98bd-4446-b38d-9028df064734 ==============================
[0m23:49:35.133924 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:49:35.134978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:49:35.546221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a70aef30>]}
[0m23:49:35.669841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a784d8b0>]}
[0m23:49:35.671820 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:49:35.859419 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:49:35.861764 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:49:35.862513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a6f77ec0>]}
[0m23:49:38.150361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a7415e50>]}
[0m23:49:38.299812 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:49:38.306312 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:49:38.384469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a532d7c0>]}
[0m23:49:38.385844 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m23:49:38.386698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a546ae70>]}
[0m23:49:38.391837 [info ] [MainThread]: 
[0m23:49:38.392486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:38.393288 [info ] [MainThread]: 
[0m23:49:38.395078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:38.407156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m23:49:38.533180 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m23:49:38.534632 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:38.535841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:38.578009 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m23:49:38.580710 [debug] [ThreadPool]: On list_football_db: Close
[0m23:49:38.582722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m23:49:38.583715 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m23:49:38.594230 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m23:49:38.594882 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m23:49:38.595422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:38.607519 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m23:49:38.608116 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m23:49:38.608567 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m23:49:38.610026 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:49:38.611828 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m23:49:38.612375 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m23:49:38.612864 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m23:49:38.615859 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m23:49:38.616621 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m23:49:38.621967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m23:49:38.635343 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m23:49:38.636115 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m23:49:38.636605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:38.647029 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m23:49:38.648175 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m23:49:38.649092 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:49:38.656929 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m23:49:38.659049 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m23:49:38.659966 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m23:49:38.672429 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:38.673164 [debug] [MainThread]: On master: BEGIN
[0m23:49:38.673690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:38.684191 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:49:38.685121 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:38.686098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:49:38.692629 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m23:49:38.695013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a53a8500>]}
[0m23:49:38.695871 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:38.697034 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:38.697649 [debug] [MainThread]: On master: BEGIN
[0m23:49:38.698763 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:49:38.699264 [debug] [MainThread]: On master: COMMIT
[0m23:49:38.699961 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:38.701325 [debug] [MainThread]: On master: COMMIT
[0m23:49:38.702819 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:49:38.703458 [debug] [MainThread]: On master: Close
[0m23:49:38.711040 [debug] [Thread-1 (]: Began running node model.football_dbt.dim_teams
[0m23:49:38.711744 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_competitions
[0m23:49:38.712895 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_matches
[0m23:49:38.714591 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_players
[0m23:49:38.713847 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.dim_teams ................................ [RUN]
[0m23:49:38.716182 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_competitions ......................... [RUN]
[0m23:49:38.717603 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics.stg_matches .............................. [RUN]
[0m23:49:38.718919 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics.stg_players .............................. [RUN]
[0m23:49:38.720092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.dim_teams)
[0m23:49:38.721178 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_competitions'
[0m23:49:38.722499 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m23:49:38.723596 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m23:49:38.724432 [debug] [Thread-1 (]: Began compiling node model.football_dbt.dim_teams
[0m23:49:38.725257 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_competitions
[0m23:49:38.725896 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_matches
[0m23:49:38.726492 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_players
[0m23:49:38.836875 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.dim_teams"
[0m23:49:38.841213 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m23:49:38.846646 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m23:49:38.851097 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m23:49:38.861302 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_matches
[0m23:49:38.869281 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_competitions
[0m23:49:38.918237 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_players
[0m23:49:38.925613 [debug] [Thread-1 (]: Began executing node model.football_dbt.dim_teams
[0m23:49:38.977605 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m23:49:38.980231 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m23:49:38.987030 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m23:49:38.988969 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.dim_teams"
[0m23:49:38.994112 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.dim_teams"
[0m23:49:38.994592 [debug] [Thread-1 (]: On model.football_dbt.dim_teams: BEGIN
[0m23:49:38.995683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:38.996700 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m23:49:38.997426 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m23:49:38.997893 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_players"
[0m23:49:38.998818 [debug] [Thread-2 (]: On model.football_dbt.stg_competitions: BEGIN
[0m23:49:38.999588 [debug] [Thread-3 (]: On model.football_dbt.stg_matches: BEGIN
[0m23:49:39.000198 [debug] [Thread-4 (]: On model.football_dbt.stg_players: BEGIN
[0m23:49:39.000866 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:49:39.001592 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:49:39.002239 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:49:39.008729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:49:39.009381 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.dim_teams"
[0m23:49:39.009838 [debug] [Thread-1 (]: On model.football_dbt.dim_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.dim_teams"} */

  create view "football_db"."analytics"."dim_teams__dbt_tmp"
    
    
  as (
    select * from
  );
[0m23:49:39.011984 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m23:49:39.012898 [debug] [Thread-1 (]: On model.football_dbt.dim_teams: ROLLBACK
[0m23:49:39.014192 [debug] [Thread-1 (]: On model.football_dbt.dim_teams: Close
[0m23:49:39.014914 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:49:39.015624 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m23:49:39.016471 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m23:49:39.019582 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m23:49:39.020493 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m23:49:39.021979 [debug] [Thread-3 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with sources as (
    select 
        id,
        date,
        area,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team -> "name"):: TEXT as home_team,
        (away_team -> "name"):: TEXT as away_team,
        (home_team -> "tla"):: TEXT as home_team_code,
        (away_team -> "tla"):: TEXT as away_team_code,
        (score -> "winner"):: TEXT as result,
        (score -> "fullTime" ->> "home")::INT as home_final_score,
        (score -> "fullTime" ->> "away")::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from sources
  );
[0m23:49:39.023219 [debug] [Thread-2 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> "currentSeason" ->> currentMatchday):: INT as current_matchday,
    (raw_payload -> "numberOfAvailableSeasons"):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions"
  );
[0m23:49:39.024229 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_players"
[0m23:49:39.026126 [debug] [Thread-4 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    select 
    players.id,
    players.name,
    players.first_name,
    players.last_name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on p.current_team = t.id
  );
[0m23:49:39.027275 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "area" does not exist
LINE 11:         area,
                 ^

[0m23:49:39.028038 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "currentSeason" does not exist
LINE 19:     (raw_payload -> "currentSeason" ->> currentMatchday):: I...
                             ^

[0m23:49:39.029479 [debug] [Thread-3 (]: On model.football_dbt.stg_matches: ROLLBACK
[0m23:49:39.030938 [debug] [Thread-2 (]: On model.football_dbt.stg_competitions: ROLLBACK
[0m23:49:39.031653 [debug] [Thread-4 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "p"
LINE 20: on p.current_team = t.id
            ^

[0m23:49:39.033336 [debug] [Thread-4 (]: On model.football_dbt.stg_players: ROLLBACK
[0m23:49:39.034325 [debug] [Thread-2 (]: On model.football_dbt.stg_competitions: Close
[0m23:49:39.035280 [debug] [Thread-3 (]: On model.football_dbt.stg_matches: Close
[0m23:49:39.038953 [debug] [Thread-4 (]: On model.football_dbt.stg_players: Close
[0m23:49:39.059310 [debug] [Thread-4 (]: Database Error in model stg_players (models/staging/stg_players.sql)
  missing FROM-clause entry for table "p"
  LINE 20: on p.current_team = t.id
              ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m23:49:39.064179 [debug] [Thread-2 (]: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  column "currentSeason" does not exist
  LINE 19:     (raw_payload -> "currentSeason" ->> currentMatchday):: I...
                               ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m23:49:39.067340 [debug] [Thread-3 (]: Database Error in model stg_matches (models/staging/stg_matches.sql)
  column "area" does not exist
  LINE 11:         area,
                   ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m23:49:39.074804 [debug] [Thread-1 (]: Database Error in model dim_teams (models/marts/dim_teams.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/football_dbt/models/marts/dim_teams.sql
[0m23:49:39.077633 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042863442f0>]}
[0m23:49:39.078756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70428715d220>]}
[0m23:49:39.079636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70428649e2a0>]}
[0m23:49:39.080648 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a57a0ec0>]}
[0m23:49:39.081921 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model analytics.stg_players ..................... [[31mERROR[0m in 0.35s]
[0m23:49:39.083423 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model analytics.dim_teams ....................... [[31mERROR[0m in 0.36s]
[0m23:49:39.084949 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model analytics.stg_competitions ................ [[31mERROR[0m in 0.36s]
[0m23:49:39.086499 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model analytics.stg_matches ..................... [[31mERROR[0m in 0.35s]
[0m23:49:39.087938 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_players
[0m23:49:39.089028 [debug] [Thread-1 (]: Finished running node model.football_dbt.dim_teams
[0m23:49:39.090147 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_competitions
[0m23:49:39.090955 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_matches
[0m23:49:39.091728 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m23:49:39.092881 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_players' to be skipped because of status 'error'.  Reason: Database Error in model stg_players (models/staging/stg_players.sql)
  missing FROM-clause entry for table "p"
  LINE 20: on p.current_team = t.id
              ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql.
[0m23:49:39.095042 [info ] [Thread-4 (]: 5 of 5 START sql view model analytics.stg_teams ................................ [RUN]
[0m23:49:39.098048 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.dim_teams' to be skipped because of status 'error'.  Reason: Database Error in model dim_teams (models/marts/dim_teams.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/football_dbt/models/marts/dim_teams.sql.
[0m23:49:39.098989 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.football_dbt.stg_players, now model.football_dbt.stg_teams)
[0m23:49:39.100013 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_competitions' to be skipped because of status 'error'.  Reason: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  column "currentSeason" does not exist
  LINE 19:     (raw_payload -> "currentSeason" ->> currentMatchday):: I...
                               ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql.
[0m23:49:39.100692 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m23:49:39.101748 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_matches' to be skipped because of status 'error'.  Reason: Database Error in model stg_matches (models/staging/stg_matches.sql)
  column "area" does not exist
  LINE 11:         area,
                   ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql.
[0m23:49:39.106437 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m23:49:39.107677 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m23:49:39.111936 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m23:49:39.112870 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m23:49:39.113468 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m23:49:39.113915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:39.124538 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:49:39.125498 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m23:49:39.126120 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams"
  );
[0m23:49:39.130219 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:39.143456 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m23:49:39.144192 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
alter table "football_db"."analytics"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m23:49:39.145537 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:39.169681 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m23:49:39.170310 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m23:49:39.171099 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m23:49:39.173818 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:39.186647 [debug] [Thread-4 (]: Applying DROP to: "football_db"."analytics"."stg_teams__dbt_backup"
[0m23:49:39.199387 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m23:49:39.200089 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
drop view if exists "football_db"."analytics"."stg_teams__dbt_backup" cascade
[0m23:49:39.202075 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:39.206815 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m23:49:39.207938 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39da82b3-98bd-4446-b38d-9028df064734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a8f4e4b0>]}
[0m23:49:39.209096 [info ] [Thread-4 (]: 5 of 5 OK created sql view model analytics.stg_teams ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:49:39.210432 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m23:49:39.215679 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:39.216666 [debug] [MainThread]: On master: BEGIN
[0m23:49:39.217823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:39.229161 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:49:39.229898 [debug] [MainThread]: On master: COMMIT
[0m23:49:39.230309 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:39.230850 [debug] [MainThread]: On master: COMMIT
[0m23:49:39.231761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:39.232755 [debug] [MainThread]: On master: Close
[0m23:49:39.234147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:39.234804 [debug] [MainThread]: Connection 'model.football_dbt.dim_teams' was properly closed.
[0m23:49:39.235234 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m23:49:39.235769 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m23:49:39.236257 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m23:49:39.237094 [info ] [MainThread]: 
[0m23:49:39.237896 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m23:49:39.240188 [debug] [MainThread]: Command end result
[0m23:49:39.284251 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:49:39.286717 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:49:39.295383 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:49:39.295808 [info ] [MainThread]: 
[0m23:49:39.296413 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m23:49:39.297172 [info ] [MainThread]: 
[0m23:49:39.298210 [error] [MainThread]:   Database Error in model stg_players (models/staging/stg_players.sql)
  missing FROM-clause entry for table "p"
  LINE 20: on p.current_team = t.id
              ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m23:49:39.298929 [info ] [MainThread]: 
[0m23:49:39.299871 [error] [MainThread]:   Database Error in model dim_teams (models/marts/dim_teams.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/football_dbt/models/marts/dim_teams.sql
[0m23:49:39.300573 [info ] [MainThread]: 
[0m23:49:39.301577 [error] [MainThread]:   Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  column "currentSeason" does not exist
  LINE 19:     (raw_payload -> "currentSeason" ->> currentMatchday):: I...
                               ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m23:49:39.302359 [info ] [MainThread]: 
[0m23:49:39.303449 [error] [MainThread]:   Database Error in model stg_matches (models/staging/stg_matches.sql)
  column "area" does not exist
  LINE 11:         area,
                   ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m23:49:39.304175 [info ] [MainThread]: 
[0m23:49:39.305595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=0 TOTAL=5
[0m23:49:39.307757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2786555, "process_in_blocks": "7616", "process_kernel_time": 0.922075, "process_mem_max_rss": "113452", "process_out_blocks": "4376", "process_user_time": 5.827061}
[0m23:49:39.308561 [debug] [MainThread]: Command `dbt run` failed at 23:49:39.308352 after 4.28 seconds
[0m23:49:39.309524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a7bd0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042a532c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7042863cff80>]}
[0m23:49:39.310371 [debug] [MainThread]: Flushing usage events
[0m23:49:41.620550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:56:17.083429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e526c60320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e526c61550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e526c60290>]}


============================== 23:56:17.093851 | ec27884c-da44-42f1-ab09-3eede3a2b7fa ==============================
[0m23:56:17.093851 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:56:17.094741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:17.416088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e526ba1400>]}
[0m23:56:17.505304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e526e03dd0>]}
[0m23:56:17.506452 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:56:17.672608 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:56:17.846648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:56:17.847467 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/marts/dim_teams.sql
[0m23:56:17.848118 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_competitions.sql
[0m23:56:17.848726 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_matches.sql
[0m23:56:18.249288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e5253d2960>]}
[0m23:56:18.360554 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:56:18.364564 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:56:18.405326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e524010ce0>]}
[0m23:56:18.406054 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m23:56:18.406836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e524f0ae70>]}
[0m23:56:18.410229 [info ] [MainThread]: 
[0m23:56:18.410847 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:18.411610 [info ] [MainThread]: 
[0m23:56:18.412755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:18.422493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m23:56:18.501186 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m23:56:18.501727 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m23:56:18.502115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:18.522454 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m23:56:18.524268 [debug] [ThreadPool]: On list_football_db: Close
[0m23:56:18.525524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m23:56:18.526215 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m23:56:18.532744 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m23:56:18.533183 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m23:56:18.533553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:18.542530 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:56:18.543500 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m23:56:18.544794 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m23:56:18.545895 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:56:18.547060 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m23:56:18.547498 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m23:56:18.547924 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m23:56:18.549941 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:56:18.550477 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m23:56:18.553641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m23:56:18.563388 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m23:56:18.564074 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m23:56:18.564753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:18.576777 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m23:56:18.577356 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m23:56:18.578260 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:56:18.584321 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m23:56:18.586499 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m23:56:18.587393 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m23:56:18.598845 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:18.599489 [debug] [MainThread]: On master: BEGIN
[0m23:56:18.599888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:18.609235 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:56:18.610124 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:18.611013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:18.617012 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:56:18.618950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e5250c5c10>]}
[0m23:56:18.619666 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:18.620511 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:18.620945 [debug] [MainThread]: On master: BEGIN
[0m23:56:18.622127 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:56:18.622865 [debug] [MainThread]: On master: COMMIT
[0m23:56:18.623478 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:18.624109 [debug] [MainThread]: On master: COMMIT
[0m23:56:18.625140 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:18.625819 [debug] [MainThread]: On master: Close
[0m23:56:18.633398 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m23:56:18.634146 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m23:56:18.634840 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m23:56:18.635394 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m23:56:18.636375 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m23:56:18.637345 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m23:56:18.639330 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m23:56:18.640601 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m23:56:18.641862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m23:56:18.643447 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m23:56:18.644644 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m23:56:18.645767 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m23:56:18.646435 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m23:56:18.647017 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m23:56:18.647673 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m23:56:18.648484 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m23:56:18.663445 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m23:56:18.667960 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m23:56:18.672683 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m23:56:18.676374 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m23:56:18.678777 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m23:56:18.684875 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m23:56:18.691025 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m23:56:18.734257 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m23:56:18.734795 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m23:56:18.738493 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m23:56:18.742229 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m23:56:18.746613 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m23:56:18.747537 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m23:56:18.748990 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m23:56:18.749864 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m23:56:18.750647 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m23:56:18.751568 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m23:56:18.752321 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m23:56:18.752912 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m23:56:18.753622 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:56:18.754557 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m23:56:18.755432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:18.756371 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:56:18.757542 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:56:18.768682 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m23:56:18.770471 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m23:56:18.771949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:56:18.773088 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with sources as (
    select 
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team -> 'name'):: TEXT as home_team,
        (away_team -> 'name'):: TEXT as away_team,
        (home_team -> 'tla'):: TEXT as home_team_code,
        (away_team -> 'tla'):: TEXT as away_team_code,
        (score -> 'winner'):: TEXT as result,
        (score -> 'fullTime' ->> 'home')::INT as home_final_score,
        (score -> 'fullTime' ->> 'away')::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from sources
  );
[0m23:56:18.774070 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m23:56:18.775800 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m23:56:18.776736 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m23:56:18.777869 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m23:56:18.778777 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m23:56:18.779613 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.matches" does not exist
LINE 27:     from "football_db"."raw"."matches"
                  ^

[0m23:56:18.780516 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions"
  );
[0m23:56:18.781454 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    select 
    players.id,
    players.name,
    players.first_name,
    players.last_name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on p.current_team = t.id
  );
[0m23:56:18.783298 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams"
  );
[0m23:56:18.786167 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: ROLLBACK
[0m23:56:18.788614 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.players" does not exist
LINE 18: from "football_db"."raw"."players" players
              ^

[0m23:56:18.789718 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.teams" does not exist
LINE 21: from "football_db"."raw"."teams"
              ^

[0m23:56:18.790823 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m23:56:18.792933 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.competitions" does not exist
LINE 23: from "football_db"."raw"."competitions"
              ^

[0m23:56:18.793783 [debug] [Thread-3 (]: On model.football_dbt.stg_players: ROLLBACK
[0m23:56:18.794763 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: ROLLBACK
[0m23:56:18.795777 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: ROLLBACK
[0m23:56:18.800506 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m23:56:18.802907 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m23:56:18.803778 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m23:56:18.830387 [debug] [Thread-2 (]: Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m23:56:18.836101 [debug] [Thread-1 (]: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m23:56:18.841491 [debug] [Thread-3 (]: Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m23:56:18.845104 [debug] [Thread-4 (]: Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql
[0m23:56:18.846803 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e50e08a930>]}
[0m23:56:18.847648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e50e0bf950>]}
[0m23:56:18.848706 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e524f0b9b0>]}
[0m23:56:18.850050 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec27884c-da44-42f1-ab09-3eede3a2b7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e50e0754f0>]}
[0m23:56:18.851640 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics.stg_matches ..................... [[31mERROR[0m in 0.19s]
[0m23:56:18.853270 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics.stg_competitions ................ [[31mERROR[0m in 0.20s]
[0m23:56:18.855006 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model analytics.stg_players ..................... [[31mERROR[0m in 0.20s]
[0m23:56:18.857386 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model analytics.stg_teams ....................... [[31mERROR[0m in 0.20s]
[0m23:56:18.859225 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m23:56:18.860676 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m23:56:18.861676 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m23:56:18.862637 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m23:56:18.864337 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_matches' to be skipped because of status 'error'.  Reason: Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql.
[0m23:56:18.871795 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_competitions' to be skipped because of status 'error'.  Reason: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql.
[0m23:56:18.873948 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_players' to be skipped because of status 'error'.  Reason: Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql.
[0m23:56:18.875624 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_teams' to be skipped because of status 'error'.  Reason: Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql.
[0m23:56:18.881019 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:18.881999 [debug] [MainThread]: On master: BEGIN
[0m23:56:18.882858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:18.900172 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m23:56:18.901158 [debug] [MainThread]: On master: COMMIT
[0m23:56:18.902036 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:18.902737 [debug] [MainThread]: On master: COMMIT
[0m23:56:18.904053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:18.904895 [debug] [MainThread]: On master: Close
[0m23:56:18.906036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:18.906623 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m23:56:18.907113 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m23:56:18.907665 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m23:56:18.908377 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m23:56:18.909582 [info ] [MainThread]: 
[0m23:56:18.910463 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m23:56:18.913865 [debug] [MainThread]: Command end result
[0m23:56:18.976887 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:56:18.980589 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:56:18.994492 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:56:18.995554 [info ] [MainThread]: 
[0m23:56:18.996603 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m23:56:18.997493 [info ] [MainThread]: 
[0m23:56:18.998610 [error] [MainThread]:   Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m23:56:19.000033 [info ] [MainThread]: 
[0m23:56:19.001053 [error] [MainThread]:   Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m23:56:19.001887 [info ] [MainThread]: 
[0m23:56:19.003287 [error] [MainThread]:   Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m23:56:19.004231 [info ] [MainThread]: 
[0m23:56:19.005917 [error] [MainThread]:   Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql
[0m23:56:19.007764 [info ] [MainThread]: 
[0m23:56:19.008985 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m23:56:19.011532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9993514, "process_in_blocks": "0", "process_kernel_time": 0.842116, "process_mem_max_rss": "111828", "process_out_blocks": "4352", "process_user_time": 3.368464}
[0m23:56:19.012804 [debug] [MainThread]: Command `dbt run` failed at 23:56:19.012524 after 2.00 seconds
[0m23:56:19.014473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e526c61430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e52791a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e50e0aa600>]}
[0m23:56:19.015194 [debug] [MainThread]: Flushing usage events
[0m23:56:21.166973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:08.059917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658e987bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658eb1bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658e7c6600>]}


============================== 00:03:08.076057 | 17159069-6c2f-42f4-b3bb-b6b1abc95ec7 ==============================
[0m00:03:08.076057 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:03:08.079277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:03:08.429697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658e238d40>]}
[0m00:03:08.522462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658fbff830>]}
[0m00:03:08.523847 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:03:08.701923 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:03:08.867042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:03:08.868535 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/sources/sources.yml
[0m00:03:09.482129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786586312f90>]}
[0m00:03:09.596970 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:03:09.600676 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:03:09.638891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658e1f7d70>]}
[0m00:03:09.639582 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:03:09.640236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865862309e0>]}
[0m00:03:09.644204 [info ] [MainThread]: 
[0m00:03:09.644837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:03:09.645568 [info ] [MainThread]: 
[0m00:03:09.646658 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:03:09.655304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m00:03:09.729230 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m00:03:09.729852 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m00:03:09.730406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:09.749540 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m00:03:09.751552 [debug] [ThreadPool]: On list_football_db: Close
[0m00:03:09.752679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m00:03:09.753262 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m00:03:09.759683 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:03:09.760124 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m00:03:09.760561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:09.769926 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m00:03:09.770690 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:03:09.772226 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m00:03:09.773571 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m00:03:09.774865 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:03:09.775316 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:03:09.775712 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:03:09.777920 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m00:03:09.778381 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m00:03:09.781464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m00:03:09.794769 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:03:09.795536 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m00:03:09.796159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:09.808201 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m00:03:09.808973 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:03:09.809759 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m00:03:09.816397 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m00:03:09.818694 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m00:03:09.819591 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m00:03:09.827671 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:09.828275 [debug] [MainThread]: On master: BEGIN
[0m00:03:09.828708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:09.839537 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:03:09.841222 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:09.842458 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:03:09.849372 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:03:09.851553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658e17f4a0>]}
[0m00:03:09.852325 [debug] [MainThread]: On master: ROLLBACK
[0m00:03:09.853272 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:09.853844 [debug] [MainThread]: On master: BEGIN
[0m00:03:09.855155 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:03:09.855949 [debug] [MainThread]: On master: COMMIT
[0m00:03:09.856659 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:09.857817 [debug] [MainThread]: On master: COMMIT
[0m00:03:09.858581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:03:09.859023 [debug] [MainThread]: On master: Close
[0m00:03:09.865589 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m00:03:09.866668 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m00:03:09.867498 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m00:03:09.868983 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m00:03:09.868364 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m00:03:09.870444 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m00:03:09.871742 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m00:03:09.872903 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m00:03:09.874164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m00:03:09.875342 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m00:03:09.876594 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m00:03:09.877592 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m00:03:09.878731 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m00:03:09.879569 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m00:03:09.880296 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m00:03:09.880913 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m00:03:09.892565 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m00:03:09.897903 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m00:03:09.902327 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m00:03:09.907174 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m00:03:09.908919 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m00:03:09.909672 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m00:03:09.921518 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m00:03:09.945007 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m00:03:09.980553 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m00:03:09.981182 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m00:03:09.984868 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m00:03:09.989994 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m00:03:09.991784 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:03:09.992618 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:03:09.993529 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:03:09.994187 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m00:03:09.994809 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:03:09.995331 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m00:03:09.995871 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m00:03:09.996491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:09.997148 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m00:03:09.997868 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:03:09.998446 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:03:09.999399 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:03:10.009232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m00:03:10.010217 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:03:10.011170 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m00:03:10.011976 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions"
  );
[0m00:03:10.012843 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m00:03:10.013708 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:03:10.014820 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:03:10.015649 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with sources as (
    select 
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team -> 'name'):: TEXT as home_team,
        (away_team -> 'name'):: TEXT as away_team,
        (home_team -> 'tla'):: TEXT as home_team_code,
        (away_team -> 'tla'):: TEXT as away_team_code,
        (score -> 'winner'):: TEXT as result,
        (score -> 'fullTime' ->> 'home')::INT as home_final_score,
        (score -> 'fullTime' ->> 'away')::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from sources
  );
[0m00:03:10.016780 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m00:03:10.017898 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.competitions" does not exist
LINE 23: from "football_db"."raw"."competitions"
              ^

[0m00:03:10.018680 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    select 
    players.id,
    players.name,
    players.first_name,
    players.last_name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on p.current_team = t.id
  );
[0m00:03:10.019636 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:03:10.020704 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.matches" does not exist
LINE 27:     from "football_db"."raw"."matches"
                  ^

[0m00:03:10.021667 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: ROLLBACK
[0m00:03:10.022816 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams"
  );
[0m00:03:10.023753 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.players" does not exist
LINE 18: from "football_db"."raw"."players" players
              ^

[0m00:03:10.024551 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: ROLLBACK
[0m00:03:10.025816 [debug] [Thread-3 (]: On model.football_dbt.stg_players: ROLLBACK
[0m00:03:10.026776 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.teams" does not exist
LINE 21: from "football_db"."raw"."teams"
              ^

[0m00:03:10.027808 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m00:03:10.028961 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: ROLLBACK
[0m00:03:10.029864 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m00:03:10.030663 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m00:03:10.034311 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m00:03:10.070388 [debug] [Thread-1 (]: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m00:03:10.073835 [debug] [Thread-3 (]: Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m00:03:10.084583 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865854e9dc0>]}
[0m00:03:10.086600 [debug] [Thread-4 (]: Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql
[0m00:03:10.058630 [debug] [Thread-2 (]: Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m00:03:10.089190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658ecfe5d0>]}
[0m00:03:10.090894 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model analytics.stg_players ..................... [[31mERROR[0m in 0.20s]
[0m00:03:10.096665 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m00:03:10.093625 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865854c6420>]}
[0m00:03:10.092439 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17159069-6c2f-42f4-b3bb-b6b1abc95ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865854ea0f0>]}
[0m00:03:10.097864 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_players' to be skipped because of status 'error'.  Reason: Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql.
[0m00:03:10.099268 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics.stg_matches ..................... [[31mERROR[0m in 0.22s]
[0m00:03:10.095312 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics.stg_competitions ................ [[31mERROR[0m in 0.20s]
[0m00:03:10.100697 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model analytics.stg_teams ....................... [[31mERROR[0m in 0.21s]
[0m00:03:10.104316 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m00:03:10.107199 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m00:03:10.109134 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m00:03:10.110956 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_matches' to be skipped because of status 'error'.  Reason: Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql.
[0m00:03:10.113022 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_competitions' to be skipped because of status 'error'.  Reason: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql.
[0m00:03:10.114484 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_teams' to be skipped because of status 'error'.  Reason: Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql.
[0m00:03:10.124013 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:10.125369 [debug] [MainThread]: On master: BEGIN
[0m00:03:10.128718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:10.146159 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m00:03:10.146978 [debug] [MainThread]: On master: COMMIT
[0m00:03:10.147763 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:10.148467 [debug] [MainThread]: On master: COMMIT
[0m00:03:10.149572 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:03:10.150651 [debug] [MainThread]: On master: Close
[0m00:03:10.151581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:10.152144 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m00:03:10.152630 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m00:03:10.153101 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m00:03:10.153569 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m00:03:10.154404 [info ] [MainThread]: 
[0m00:03:10.155059 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m00:03:10.157995 [debug] [MainThread]: Command end result
[0m00:03:10.206254 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:03:10.208966 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:03:10.218529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:03:10.219064 [info ] [MainThread]: 
[0m00:03:10.219771 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:03:10.221038 [info ] [MainThread]: 
[0m00:03:10.222517 [error] [MainThread]:   Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m00:03:10.223717 [info ] [MainThread]: 
[0m00:03:10.225100 [error] [MainThread]:   Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m00:03:10.226147 [info ] [MainThread]: 
[0m00:03:10.227282 [error] [MainThread]:   Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m00:03:10.228718 [info ] [MainThread]: 
[0m00:03:10.230065 [error] [MainThread]:   Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql
[0m00:03:10.230893 [info ] [MainThread]: 
[0m00:03:10.232123 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:03:10.234354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2718313, "process_in_blocks": "0", "process_kernel_time": 0.715255, "process_mem_max_rss": "114052", "process_out_blocks": "4344", "process_user_time": 3.878443}
[0m00:03:10.235930 [debug] [MainThread]: Command `dbt run` failed at 00:03:10.235661 after 2.27 seconds
[0m00:03:10.236815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658e987bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658f177680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78658ed1ef00>]}
[0m00:03:10.237669 [debug] [MainThread]: Flushing usage events
[0m00:03:12.245384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:05:20.322101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d45dd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d5a68cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d42bbbf0>]}


============================== 00:05:20.335595 | a66b8bfc-8d66-4fa5-b269-8986f6043580 ==============================
[0m00:05:20.335595 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:05:20.337534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:05:20.635525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d59ebb60>]}
[0m00:05:20.728017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d3d710a0>]}
[0m00:05:20.733288 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:05:20.905925 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:05:21.079133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:05:21.080572 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_players.sql
[0m00:05:21.081372 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_matches.sql
[0m00:05:21.513392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d1edea20>]}
[0m00:05:21.628527 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:05:21.632624 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:05:21.671681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d1f33d10>]}
[0m00:05:21.672388 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:05:21.672996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d2030530>]}
[0m00:05:21.676626 [info ] [MainThread]: 
[0m00:05:21.677335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:05:21.678744 [info ] [MainThread]: 
[0m00:05:21.682470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:05:21.690923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m00:05:21.767259 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m00:05:21.767813 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m00:05:21.768406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:21.788777 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m00:05:21.790965 [debug] [ThreadPool]: On list_football_db: Close
[0m00:05:21.792243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m00:05:21.792911 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m00:05:21.799146 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:05:21.799570 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m00:05:21.800033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:05:21.809050 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m00:05:21.809568 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:05:21.810194 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m00:05:21.811907 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m00:05:21.813149 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:05:21.813544 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:05:21.813976 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:05:21.816277 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m00:05:21.816745 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m00:05:21.820059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m00:05:21.834320 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:05:21.835158 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m00:05:21.835595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:05:21.846291 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:05:21.846916 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:05:21.847562 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m00:05:21.854604 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m00:05:21.856966 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m00:05:21.857770 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m00:05:21.866026 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:21.866613 [debug] [MainThread]: On master: BEGIN
[0m00:05:21.867145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:05:21.877041 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:05:21.877615 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:21.878504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:05:21.884590 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:05:21.886651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d1f2d040>]}
[0m00:05:21.887327 [debug] [MainThread]: On master: ROLLBACK
[0m00:05:21.888586 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:21.889112 [debug] [MainThread]: On master: BEGIN
[0m00:05:21.890366 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:05:21.891024 [debug] [MainThread]: On master: COMMIT
[0m00:05:21.891790 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:21.892550 [debug] [MainThread]: On master: COMMIT
[0m00:05:21.893644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:05:21.894335 [debug] [MainThread]: On master: Close
[0m00:05:21.901251 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m00:05:21.902121 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m00:05:21.902880 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m00:05:21.904622 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m00:05:21.903833 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m00:05:21.905926 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m00:05:21.907235 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m00:05:21.908593 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m00:05:21.910093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m00:05:21.911354 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m00:05:21.912451 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m00:05:21.913494 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m00:05:21.914296 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m00:05:21.915069 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m00:05:21.915736 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m00:05:21.916542 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m00:05:21.931798 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m00:05:21.933109 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m00:05:21.937205 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m00:05:21.941605 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m00:05:21.943289 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m00:05:21.944651 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m00:05:21.956650 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m00:05:21.972914 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m00:05:22.012162 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m00:05:22.015097 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m00:05:22.018747 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m00:05:22.023926 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m00:05:22.025919 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:05:22.027260 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:05:22.027882 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:05:22.028580 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m00:05:22.029212 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:05:22.029726 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m00:05:22.030277 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m00:05:22.030821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:22.031413 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m00:05:22.032161 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:05:22.032705 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:05:22.033669 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:05:22.043624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m00:05:22.044780 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:05:22.045843 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m00:05:22.046777 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions"
  );
[0m00:05:22.048015 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m00:05:22.048839 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:05:22.049694 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m00:05:22.050742 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:05:22.051688 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.competitions" does not exist
LINE 23: from "football_db"."raw"."competitions"
              ^

[0m00:05:22.052530 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    select 
    players.id,
    players.name,
    players.first_name,
    players.last_name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" as players
left join "football_db"."raw"."teams" team
on p.current_team = t.id
  );
[0m00:05:22.053489 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:05:22.054379 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with sources as (
    select 
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team -> 'name'):: TEXT as home_team,
        (away_team -> 'name'):: TEXT as away_team,
        (home_team -> 'tla'):: TEXT as home_team_code,
        (away_team -> 'tla'):: TEXT as away_team_code,
        (score -> 'winner'):: TEXT as result,
        (score -> 'fullTime' ->> 'home')::INT as home_final_score,
        (score -> 'fullTime' ->> 'away')::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)
  );
[0m00:05:22.055300 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: ROLLBACK
[0m00:05:22.056569 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams"
  );
[0m00:05:22.057461 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.players" does not exist
LINE 18: from "football_db"."raw"."players" as players
              ^

[0m00:05:22.058390 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:   );
           ^

[0m00:05:22.059459 [debug] [Thread-3 (]: On model.football_dbt.stg_players: ROLLBACK
[0m00:05:22.060355 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m00:05:22.061255 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.teams" does not exist
LINE 21: from "football_db"."raw"."teams"
              ^

[0m00:05:22.061997 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: ROLLBACK
[0m00:05:22.065231 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: ROLLBACK
[0m00:05:22.066480 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m00:05:22.070244 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m00:05:22.072524 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m00:05:22.095736 [debug] [Thread-1 (]: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m00:05:22.098174 [debug] [Thread-2 (]: Database Error in model stg_matches (models/staging/stg_matches.sql)
  syntax error at or near ")"
  LINE 29:   );
             ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m00:05:22.099790 [debug] [Thread-3 (]: Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" as players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m00:05:22.105603 [debug] [Thread-4 (]: Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql
[0m00:05:22.107276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d45de420>]}
[0m00:05:22.108296 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762caeb47d0>]}
[0m00:05:22.109102 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762cae91220>]}
[0m00:05:22.109992 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a66b8bfc-8d66-4fa5-b269-8986f6043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762caeb4bf0>]}
[0m00:05:22.111780 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics.stg_competitions ................ [[31mERROR[0m in 0.19s]
[0m00:05:22.113542 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics.stg_matches ..................... [[31mERROR[0m in 0.20s]
[0m00:05:22.115083 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model analytics.stg_players ..................... [[31mERROR[0m in 0.20s]
[0m00:05:22.116511 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model analytics.stg_teams ....................... [[31mERROR[0m in 0.20s]
[0m00:05:22.118182 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m00:05:22.119309 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m00:05:22.120556 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m00:05:22.121709 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m00:05:22.123052 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_competitions' to be skipped because of status 'error'.  Reason: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql.
[0m00:05:22.125903 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_matches' to be skipped because of status 'error'.  Reason: Database Error in model stg_matches (models/staging/stg_matches.sql)
  syntax error at or near ")"
  LINE 29:   );
             ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql.
[0m00:05:22.126997 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_players' to be skipped because of status 'error'.  Reason: Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" as players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql.
[0m00:05:22.128659 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_teams' to be skipped because of status 'error'.  Reason: Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql.
[0m00:05:22.133206 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:22.133981 [debug] [MainThread]: On master: BEGIN
[0m00:05:22.134468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:05:22.147294 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:05:22.148563 [debug] [MainThread]: On master: COMMIT
[0m00:05:22.149378 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:22.150101 [debug] [MainThread]: On master: COMMIT
[0m00:05:22.151554 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:05:22.152544 [debug] [MainThread]: On master: Close
[0m00:05:22.153476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:05:22.154110 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m00:05:22.154646 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m00:05:22.154983 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m00:05:22.155308 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m00:05:22.155989 [info ] [MainThread]: 
[0m00:05:22.156807 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:05:22.159113 [debug] [MainThread]: Command end result
[0m00:05:22.214279 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:05:22.218120 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:05:22.234531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:05:22.235176 [info ] [MainThread]: 
[0m00:05:22.236275 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:05:22.237261 [info ] [MainThread]: 
[0m00:05:22.238604 [error] [MainThread]:   Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m00:05:22.239335 [info ] [MainThread]: 
[0m00:05:22.240583 [error] [MainThread]:   Database Error in model stg_matches (models/staging/stg_matches.sql)
  syntax error at or near ")"
  LINE 29:   );
             ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m00:05:22.241524 [info ] [MainThread]: 
[0m00:05:22.242350 [error] [MainThread]:   Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" as players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m00:05:22.243015 [info ] [MainThread]: 
[0m00:05:22.244063 [error] [MainThread]:   Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams"
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql
[0m00:05:22.244775 [info ] [MainThread]: 
[0m00:05:22.245597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:05:22.247919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0010657, "process_in_blocks": "0", "process_kernel_time": 0.775059, "process_mem_max_rss": "112036", "process_out_blocks": "4352", "process_user_time": 3.441726}
[0m00:05:22.249269 [debug] [MainThread]: Command `dbt run` failed at 00:05:22.248983 after 2.00 seconds
[0m00:05:22.250157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d3d257c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762d3e8ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7762cafc7470>]}
[0m00:05:22.250836 [debug] [MainThread]: Flushing usage events
[0m00:05:24.325230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:43.974295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b4de18cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b4dfa4a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b4de2e4bc0>]}


============================== 00:12:43.984973 | 15de159a-2043-4fe7-8a54-320868447d81 ==============================
[0m00:12:43.984973 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:12:43.986067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:12:43.990376 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'football_dbt'
[0m00:12:43.992555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08467744, "process_in_blocks": "0", "process_kernel_time": 0.521822, "process_mem_max_rss": "86488", "process_out_blocks": "1472", "process_user_time": 1.961597}
[0m00:12:43.993554 [debug] [MainThread]: Command `dbt run` failed at 00:12:43.993304 after 0.09 seconds
[0m00:12:43.994272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b4de6a5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b4ddec45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b4ddbec080>]}
[0m00:12:43.994939 [debug] [MainThread]: Flushing usage events
[0m00:12:45.830935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:13:47.817196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6e486d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6f87ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6f9001a0>]}


============================== 00:13:47.828134 | 236184a9-0d51-42c3-a196-475516428940 ==============================
[0m00:13:47.828134 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:13:47.829143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:13:48.171357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6dc6d070>]}
[0m00:13:48.350860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6df9ec30>]}
[0m00:13:48.352891 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:13:48.566495 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:13:48.731758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m00:13:48.732691 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_teams.sql
[0m00:13:48.733337 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_competitions.sql
[0m00:13:48.733881 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_players.sql
[0m00:13:48.734438 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_matches.sql
[0m00:13:49.187858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6c129910>]}
[0m00:13:49.314660 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:13:49.318916 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:13:49.362332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa69b82960>]}
[0m00:13:49.363048 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:13:49.363573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6bcaae70>]}
[0m00:13:49.366313 [info ] [MainThread]: 
[0m00:13:49.366927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:13:49.367413 [info ] [MainThread]: 
[0m00:13:49.368305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:13:49.374004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m00:13:49.451397 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m00:13:49.451982 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m00:13:49.452408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:49.471905 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m00:13:49.473825 [debug] [ThreadPool]: On list_football_db: Close
[0m00:13:49.474929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m00:13:49.475544 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m00:13:49.481932 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:13:49.482364 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m00:13:49.482835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:49.499321 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m00:13:49.500308 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:13:49.500895 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m00:13:49.502710 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m00:13:49.504092 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:13:49.504551 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:13:49.504942 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:13:49.507474 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m00:13:49.508345 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m00:13:49.512193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m00:13:49.527243 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:13:49.528396 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m00:13:49.529126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:49.541159 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m00:13:49.541801 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:13:49.542217 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m00:13:49.548745 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m00:13:49.551266 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m00:13:49.552627 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m00:13:49.560916 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:49.561571 [debug] [MainThread]: On master: BEGIN
[0m00:13:49.562094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:13:49.572334 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:13:49.573164 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:49.574105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:13:49.582205 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:13:49.585279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6bd3f410>]}
[0m00:13:49.586221 [debug] [MainThread]: On master: ROLLBACK
[0m00:13:49.587325 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:49.588333 [debug] [MainThread]: On master: BEGIN
[0m00:13:49.589923 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:13:49.591517 [debug] [MainThread]: On master: COMMIT
[0m00:13:49.592429 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:49.593194 [debug] [MainThread]: On master: COMMIT
[0m00:13:49.594528 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:13:49.595391 [debug] [MainThread]: On master: Close
[0m00:13:49.601808 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m00:13:49.602810 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m00:13:49.603950 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m00:13:49.605382 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m00:13:49.604853 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m00:13:49.606827 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m00:13:49.608488 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m00:13:49.609947 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m00:13:49.613919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m00:13:49.615835 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m00:13:49.617119 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m00:13:49.618086 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m00:13:49.618812 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m00:13:49.619592 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m00:13:49.620412 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m00:13:49.621351 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m00:13:49.633768 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m00:13:49.638220 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m00:13:49.642683 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m00:13:49.646613 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m00:13:49.648378 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m00:13:49.648931 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m00:13:49.655416 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m00:13:49.666081 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m00:13:49.713472 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m00:13:49.713974 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m00:13:49.718176 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m00:13:49.724174 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m00:13:49.727192 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:13:49.728116 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:13:49.728722 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:13:49.729363 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m00:13:49.730007 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m00:13:49.730566 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:13:49.731167 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m00:13:49.732024 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:13:49.732704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:49.733305 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m00:13:49.733882 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:13:49.735118 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:13:49.745656 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m00:13:49.746490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m00:13:49.747205 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:13:49.748299 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:13:49.749527 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m00:13:49.750361 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m00:13:49.751066 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with matches_sources as (
    select 
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team -> 'name'):: TEXT as home_team,
        (away_team -> 'name'):: TEXT as away_team,
        (home_team -> 'tla'):: TEXT as home_team_code,
        (away_team -> 'tla'):: TEXT as away_team_code,
        (score -> 'winner'):: TEXT as result,
        (score -> 'fullTime' ->> 'home')::INT as home_final_score,
        (score -> 'fullTime' ->> 'away')::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from matches_sources
  );
[0m00:13:49.752099 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    with competitions_sources as (select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions")

select * from competitions_sources
  );
[0m00:13:49.753111 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:13:49.754000 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:13:49.755169 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    with players_sources as (select 
    players.id,
    players.name,
    players.first_name,
    players.last_name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on players.current_team = team.id)

select * from players_sources
  );
[0m00:13:49.756491 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.competitions" does not exist
LINE 23: from "football_db"."raw"."competitions")
              ^

[0m00:13:49.757629 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.matches" does not exist
LINE 27:     from "football_db"."raw"."matches"
                  ^

[0m00:13:49.758556 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    with teams_sources as (select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams")

select * from teams_sources
  );
[0m00:13:49.759754 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: ROLLBACK
[0m00:13:49.760504 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: ROLLBACK
[0m00:13:49.761265 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.players" does not exist
LINE 18: from "football_db"."raw"."players" players
              ^

[0m00:13:49.762804 [debug] [Thread-3 (]: On model.football_dbt.stg_players: ROLLBACK
[0m00:13:49.763774 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.teams" does not exist
LINE 21: from "football_db"."raw"."teams")
              ^

[0m00:13:49.764722 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m00:13:49.765571 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m00:13:49.766479 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: ROLLBACK
[0m00:13:49.767304 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m00:13:49.774165 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m00:13:49.809741 [debug] [Thread-3 (]: Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m00:13:49.813198 [debug] [Thread-2 (]: Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m00:13:49.815802 [debug] [Thread-1 (]: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions")
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m00:13:49.821575 [debug] [Thread-4 (]: Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams")
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql
[0m00:13:49.822811 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa68ddaed0>]}
[0m00:13:49.823819 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa68dc1e80>]}
[0m00:13:49.824757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa68dc10d0>]}
[0m00:13:49.825756 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '236184a9-0d51-42c3-a196-475516428940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa68dcff50>]}
[0m00:13:49.827323 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model analytics.stg_players ..................... [[31mERROR[0m in 0.20s]
[0m00:13:49.829490 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics.stg_matches ..................... [[31mERROR[0m in 0.21s]
[0m00:13:49.831753 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics.stg_competitions ................ [[31mERROR[0m in 0.21s]
[0m00:13:49.833489 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model analytics.stg_teams ....................... [[31mERROR[0m in 0.21s]
[0m00:13:49.835028 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m00:13:49.836140 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m00:13:49.837241 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m00:13:49.838563 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m00:13:49.840279 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_players' to be skipped because of status 'error'.  Reason: Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql.
[0m00:13:49.843913 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_matches' to be skipped because of status 'error'.  Reason: Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql.
[0m00:13:49.852354 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_competitions' to be skipped because of status 'error'.  Reason: Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions")
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql.
[0m00:13:49.853773 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_teams' to be skipped because of status 'error'.  Reason: Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams")
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql.
[0m00:13:49.860401 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:49.861297 [debug] [MainThread]: On master: BEGIN
[0m00:13:49.861867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:13:49.894842 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m00:13:49.897060 [debug] [MainThread]: On master: COMMIT
[0m00:13:49.898244 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:49.901066 [debug] [MainThread]: On master: COMMIT
[0m00:13:49.902848 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:13:49.903776 [debug] [MainThread]: On master: Close
[0m00:13:49.905077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:49.905822 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m00:13:49.906607 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m00:13:49.907317 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m00:13:49.908092 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m00:13:49.909052 [info ] [MainThread]: 
[0m00:13:49.909959 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m00:13:49.912820 [debug] [MainThread]: Command end result
[0m00:13:49.971477 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:13:49.975074 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:13:49.992846 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:13:49.993517 [info ] [MainThread]: 
[0m00:13:49.994229 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:13:49.994804 [info ] [MainThread]: 
[0m00:13:49.995842 [error] [MainThread]:   Database Error in model stg_players (models/staging/stg_players.sql)
  relation "raw.players" does not exist
  LINE 18: from "football_db"."raw"."players" players
                ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m00:13:49.996969 [info ] [MainThread]: 
[0m00:13:49.998456 [error] [MainThread]:   Database Error in model stg_matches (models/staging/stg_matches.sql)
  relation "raw.matches" does not exist
  LINE 27:     from "football_db"."raw"."matches"
                    ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m00:13:49.999396 [info ] [MainThread]: 
[0m00:13:50.000863 [error] [MainThread]:   Database Error in model stg_competitions (models/staging/stg_competitions.sql)
  relation "raw.competitions" does not exist
  LINE 23: from "football_db"."raw"."competitions")
                ^
  compiled code at target/run/football_dbt/models/staging/stg_competitions.sql
[0m00:13:50.001827 [info ] [MainThread]: 
[0m00:13:50.002641 [error] [MainThread]:   Database Error in model stg_teams (models/staging/stg_teams.sql)
  relation "raw.teams" does not exist
  LINE 21: from "football_db"."raw"."teams")
                ^
  compiled code at target/run/football_dbt/models/staging/stg_teams.sql
[0m00:13:50.003501 [info ] [MainThread]: 
[0m00:13:50.004425 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:13:50.006290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2570016, "process_in_blocks": "0", "process_kernel_time": 0.861072, "process_mem_max_rss": "112076", "process_out_blocks": "4352", "process_user_time": 3.653741}
[0m00:13:50.007250 [debug] [MainThread]: Command `dbt run` failed at 00:13:50.007060 after 2.26 seconds
[0m00:13:50.008192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6f87ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa6e486db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa68f0fad0>]}
[0m00:13:50.008857 [debug] [MainThread]: Flushing usage events
[0m00:13:52.012974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:25:22.390153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c90e60260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c90e61520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c90e60380>]}


============================== 00:25:22.403825 | 008134e2-1d04-4800-815d-7b2ed96e23a3 ==============================
[0m00:25:22.403825 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:25:22.404928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:22.855603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c90e61070>]}
[0m00:25:22.972629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c90da7ef0>]}
[0m00:25:22.974594 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:25:23.210480 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:25:23.412947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:25:23.413537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:25:23.480280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c8f5bb590>]}
[0m00:25:23.627308 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:25:23.633106 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:25:23.694877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c8f59d580>]}
[0m00:25:23.696103 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:25:23.696874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c8f291eb0>]}
[0m00:25:23.702577 [info ] [MainThread]: 
[0m00:25:23.706598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:25:23.710126 [info ] [MainThread]: 
[0m00:25:23.711312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:25:23.725543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m00:25:23.829447 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m00:25:23.830138 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m00:25:23.830651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:23.847960 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m00:25:23.850015 [debug] [ThreadPool]: On list_football_db: Close
[0m00:25:23.851557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m00:25:23.852238 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m00:25:23.861299 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:25:23.862152 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m00:25:23.862952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:23.873965 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:25:23.874609 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:25:23.875213 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m00:25:23.876929 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m00:25:23.878610 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:25:23.879086 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:25:23.879486 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:25:23.881314 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m00:25:23.881861 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m00:25:23.885371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m00:25:23.894049 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:25:23.894624 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m00:25:23.896167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:23.909223 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m00:25:23.910466 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:25:23.911371 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m00:25:23.921290 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:25:23.924471 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m00:25:23.925581 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m00:25:23.935921 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:23.936692 [debug] [MainThread]: On master: BEGIN
[0m00:25:23.937234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:25:23.948160 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:25:23.949266 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:23.950249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:25:23.958379 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:25:23.960726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c8e48ba70>]}
[0m00:25:23.961473 [debug] [MainThread]: On master: ROLLBACK
[0m00:25:23.962547 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:23.963287 [debug] [MainThread]: On master: BEGIN
[0m00:25:23.965144 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:25:23.966216 [debug] [MainThread]: On master: COMMIT
[0m00:25:23.967072 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:23.967911 [debug] [MainThread]: On master: COMMIT
[0m00:25:23.969018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:25:23.969517 [debug] [MainThread]: On master: Close
[0m00:25:23.975658 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m00:25:23.976568 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m00:25:23.977467 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m00:25:23.978321 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m00:25:23.979241 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m00:25:23.980417 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m00:25:23.981563 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m00:25:23.983109 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m00:25:23.984530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m00:25:23.986050 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m00:25:23.987384 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m00:25:23.988636 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m00:25:23.989765 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m00:25:23.990731 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m00:25:23.991654 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m00:25:23.992496 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m00:25:24.005426 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m00:25:24.011555 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m00:25:24.016960 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m00:25:24.021061 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m00:25:24.024016 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m00:25:24.024855 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m00:25:24.037303 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m00:25:24.053421 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m00:25:24.097731 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m00:25:24.101721 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m00:25:24.103911 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m00:25:24.107624 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m00:25:24.110256 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:25:24.111182 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m00:25:24.111845 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:25:24.112671 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:25:24.113275 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:25:24.113963 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:25:24.114459 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m00:25:24.115046 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m00:25:24.115927 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m00:25:24.116586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:24.117171 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:25:24.117830 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:25:24.126577 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m00:25:24.127472 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:25:24.128429 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    with players_sources as (select 
    players.id,
    players.name,
    players.first_name,
    players.last_name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on players.current_team = team.id)

select * from players_sources
  );
[0m00:25:24.130172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m00:25:24.131335 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column players.first_name does not exist
LINE 10:     players.first_name,
             ^

[0m00:25:24.132486 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:25:24.133398 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m00:25:24.134214 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m00:25:24.135252 [debug] [Thread-3 (]: On model.football_dbt.stg_players: ROLLBACK
[0m00:25:24.136252 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    with competitions_sources as (select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions")

select * from competitions_sources
  );
[0m00:25:24.137191 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:25:24.138119 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:25:24.139829 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with matches_sources as (
    select 
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team -> 'name'):: TEXT as home_team,
        (away_team -> 'name'):: TEXT as away_team,
        (home_team -> 'tla'):: TEXT as home_team_code,
        (away_team -> 'tla'):: TEXT as away_team_code,
        (score -> 'winner'):: TEXT as result,
        (score -> 'fullTime' ->> 'home')::INT as home_final_score,
        (score -> 'fullTime' ->> 'away')::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from matches_sources
  );
[0m00:25:24.141135 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m00:25:24.142261 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    with teams_sources as (select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams")

select * from teams_sources
  );
[0m00:25:24.146659 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m00:25:24.147564 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:25:24.153969 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m00:25:24.188189 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:25:24.189905 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:25:24.191095 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:25:24.192076 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
alter table "football_db"."analytics"."stg_competitions__dbt_tmp" rename to "stg_competitions"
[0m00:25:24.193221 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
alter table "football_db"."analytics"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m00:25:24.194268 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
alter table "football_db"."analytics"."stg_matches__dbt_tmp" rename to "stg_matches"
[0m00:25:24.197530 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:25:24.204979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m00:25:24.205869 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m00:25:24.238527 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m00:25:24.242040 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m00:25:24.244327 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m00:25:24.245518 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:25:24.246461 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:25:24.247609 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:25:24.248340 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m00:25:24.249043 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m00:25:24.251118 [debug] [Thread-3 (]: Database Error in model stg_players (models/staging/stg_players.sql)
  column players.first_name does not exist
  LINE 10:     players.first_name,
               ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m00:25:24.251808 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m00:25:24.255276 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m00:25:24.256383 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:25:24.257089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c91926d50>]}
[0m00:25:24.267373 [debug] [Thread-4 (]: Applying DROP to: "football_db"."analytics"."stg_teams__dbt_backup"
[0m00:25:24.268216 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m00:25:24.271299 [debug] [Thread-1 (]: Applying DROP to: "football_db"."analytics"."stg_competitions__dbt_backup"
[0m00:25:24.272417 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model analytics.stg_players ..................... [[31mERROR[0m in 0.27s]
[0m00:25:24.289679 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:25:24.292995 [debug] [Thread-2 (]: Applying DROP to: "football_db"."analytics"."stg_matches__dbt_backup"
[0m00:25:24.294398 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:25:24.296547 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m00:25:24.297271 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
drop view if exists "football_db"."analytics"."stg_teams__dbt_backup" cascade
[0m00:25:24.298334 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:25:24.298957 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
drop view if exists "football_db"."analytics"."stg_competitions__dbt_backup" cascade
[0m00:25:24.300081 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_players' to be skipped because of status 'error'.  Reason: Database Error in model stg_players (models/staging/stg_players.sql)
  column players.first_name does not exist
  LINE 10:     players.first_name,
               ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql.
[0m00:25:24.300926 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
drop view if exists "football_db"."analytics"."stg_matches__dbt_backup" cascade
[0m00:25:24.301517 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:25:24.303334 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:25:24.306908 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m00:25:24.307495 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m00:25:24.309344 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m00:25:24.311690 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m00:25:24.312490 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c8c3531a0>]}
[0m00:25:24.313415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c8c3503e0>]}
[0m00:25:24.314428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '008134e2-1d04-4800-815d-7b2ed96e23a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c8c338200>]}
[0m00:25:24.315349 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics.stg_teams ........................... [[32mCREATE VIEW[0m in 0.32s]
[0m00:25:24.316564 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_competitions .................... [[32mCREATE VIEW[0m in 0.33s]
[0m00:25:24.317771 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_matches ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m00:25:24.319150 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m00:25:24.320256 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m00:25:24.321226 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m00:25:24.326305 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:24.327011 [debug] [MainThread]: On master: BEGIN
[0m00:25:24.327566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:25:24.338029 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:25:24.338972 [debug] [MainThread]: On master: COMMIT
[0m00:25:24.339859 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:24.341365 [debug] [MainThread]: On master: COMMIT
[0m00:25:24.342669 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:25:24.343251 [debug] [MainThread]: On master: Close
[0m00:25:24.344102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:24.344733 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m00:25:24.345304 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m00:25:24.346123 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m00:25:24.346791 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m00:25:24.347629 [info ] [MainThread]: 
[0m00:25:24.348473 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m00:25:24.351846 [debug] [MainThread]: Command end result
[0m00:25:24.398464 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:25:24.401394 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:25:24.411410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:25:24.412072 [info ] [MainThread]: 
[0m00:25:24.412843 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:25:24.414038 [info ] [MainThread]: 
[0m00:25:24.415019 [error] [MainThread]:   Database Error in model stg_players (models/staging/stg_players.sql)
  column players.first_name does not exist
  LINE 10:     players.first_name,
               ^
  compiled code at target/run/football_dbt/models/staging/stg_players.sql
[0m00:25:24.416090 [info ] [MainThread]: 
[0m00:25:24.417640 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:25:24.420843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.130995, "process_in_blocks": "0", "process_kernel_time": 0.999352, "process_mem_max_rss": "109496", "process_out_blocks": "3496", "process_user_time": 3.618346}
[0m00:25:24.422442 [debug] [MainThread]: Command `dbt run` failed at 00:25:24.422157 after 2.13 seconds
[0m00:25:24.423359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c90e610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c945928a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707c8f59eff0>]}
[0m00:25:24.424284 [debug] [MainThread]: Flushing usage events
[0m00:25:29.725358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:58.997359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370a1773440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370a15c4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370a1655760>]}


============================== 00:30:59.012649 | 8684a9da-9147-41b4-9158-2aebf0edd1cc ==============================
[0m00:30:59.012649 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:30:59.013884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:30:59.419936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370a0e6f800>]}
[0m00:30:59.575793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370a27165a0>]}
[0m00:30:59.577639 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:30:59.779652 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:31:00.006561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:31:00.008249 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_players.sql
[0m00:31:00.604048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709f14a0f0>]}
[0m00:31:00.805270 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:31:00.811487 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:31:00.907329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709cfa3fe0>]}
[0m00:31:00.908550 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:31:00.909459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709f4eafc0>]}
[0m00:31:00.914322 [info ] [MainThread]: 
[0m00:31:00.915596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:00.916518 [info ] [MainThread]: 
[0m00:31:00.922281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:00.946238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m00:31:01.051614 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m00:31:01.052572 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m00:31:01.053123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:01.071691 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m00:31:01.074119 [debug] [ThreadPool]: On list_football_db: Close
[0m00:31:01.075875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m00:31:01.076928 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m00:31:01.086425 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:31:01.087515 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m00:31:01.088693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:01.100608 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:31:01.101669 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:31:01.102880 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m00:31:01.104820 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m00:31:01.106267 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:31:01.106939 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m00:31:01.107656 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m00:31:01.110136 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m00:31:01.110785 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m00:31:01.113862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m00:31:01.124689 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:31:01.126699 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m00:31:01.127419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:01.138233 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:31:01.138969 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m00:31:01.139712 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m00:31:01.147427 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m00:31:01.149495 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m00:31:01.150481 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m00:31:01.160178 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:01.160915 [debug] [MainThread]: On master: BEGIN
[0m00:31:01.161396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:01.172547 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:31:01.173427 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:01.174526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:31:01.182436 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:31:01.184971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709f21af00>]}
[0m00:31:01.185784 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:01.186842 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:01.187582 [debug] [MainThread]: On master: BEGIN
[0m00:31:01.189265 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:31:01.190913 [debug] [MainThread]: On master: COMMIT
[0m00:31:01.191896 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:01.192452 [debug] [MainThread]: On master: COMMIT
[0m00:31:01.193389 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:01.194010 [debug] [MainThread]: On master: Close
[0m00:31:01.200319 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m00:31:01.201137 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m00:31:01.202557 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m00:31:01.205337 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m00:31:01.204512 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m00:31:01.206959 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m00:31:01.208219 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m00:31:01.210406 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m00:31:01.211863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m00:31:01.212881 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m00:31:01.213937 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m00:31:01.215378 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m00:31:01.216958 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m00:31:01.218074 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m00:31:01.219203 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m00:31:01.220443 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m00:31:01.241746 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m00:31:01.246752 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m00:31:01.252274 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m00:31:01.257931 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m00:31:01.261356 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m00:31:01.262441 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m00:31:01.268661 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m00:31:01.280816 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m00:31:01.373567 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m00:31:01.375743 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m00:31:01.376494 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m00:31:01.381273 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m00:31:01.383478 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:31:01.385157 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:31:01.386059 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:31:01.386799 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m00:31:01.387679 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m00:31:01.388426 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:31:01.388945 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m00:31:01.389592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:01.390195 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:31:01.390801 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m00:31:01.391486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:31:01.392893 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:31:01.405713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m00:31:01.407058 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m00:31:01.407831 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:31:01.409143 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m00:31:01.409978 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:31:01.411506 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    with competitions_sources as (select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions")

select * from competitions_sources
  );
[0m00:31:01.412558 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m00:31:01.413313 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:31:01.414086 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    with players_sources as (select 
    players.id,
    players.name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on players.current_team = team.id)

select * from players_sources
  );
[0m00:31:01.415314 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:31:01.416119 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with matches_sources as (
    select 
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team -> 'name'):: TEXT as home_team,
        (away_team -> 'name'):: TEXT as away_team,
        (home_team -> 'tla'):: TEXT as home_team_code,
        (away_team -> 'tla'):: TEXT as away_team_code,
        (score -> 'winner'):: TEXT as result,
        (score -> 'fullTime' ->> 'home')::INT as home_final_score,
        (score -> 'fullTime' ->> 'away')::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from matches_sources
  );
[0m00:31:01.417040 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    with teams_sources as (select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams")

select * from teams_sources
  );
[0m00:31:01.423416 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:31:01.424392 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m00:31:01.425224 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m00:31:01.426690 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m00:31:01.439940 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:31:01.446645 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:31:01.451776 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:31:01.456171 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:31:01.457037 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
alter table "football_db"."analytics"."stg_matches__dbt_tmp" rename to "stg_matches"
[0m00:31:01.457740 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
alter table "football_db"."analytics"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m00:31:01.458561 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
alter table "football_db"."analytics"."stg_competitions__dbt_tmp" rename to "stg_competitions"
[0m00:31:01.459421 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
alter table "football_db"."analytics"."stg_players__dbt_tmp" rename to "stg_players"
[0m00:31:01.461574 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:31:01.462896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:31:01.463678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:31:01.464208 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m00:31:01.485714 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m00:31:01.492860 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m00:31:01.496513 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m00:31:01.498982 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m00:31:01.500789 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:31:01.501917 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:31:01.502654 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:31:01.503400 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:31:01.504063 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m00:31:01.504691 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m00:31:01.505298 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m00:31:01.505895 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m00:31:01.508377 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m00:31:01.515289 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m00:31:01.518441 [debug] [Thread-3 (]: Applying DROP to: "football_db"."analytics"."stg_players__dbt_backup"
[0m00:31:01.519230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m00:31:01.519829 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m00:31:01.523434 [debug] [Thread-4 (]: Applying DROP to: "football_db"."analytics"."stg_teams__dbt_backup"
[0m00:31:01.532560 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m00:31:01.536219 [debug] [Thread-1 (]: Applying DROP to: "football_db"."analytics"."stg_competitions__dbt_backup"
[0m00:31:01.539848 [debug] [Thread-2 (]: Applying DROP to: "football_db"."analytics"."stg_matches__dbt_backup"
[0m00:31:01.541150 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m00:31:01.541876 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
drop view if exists "football_db"."analytics"."stg_players__dbt_backup" cascade
[0m00:31:01.542866 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m00:31:01.544144 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m00:31:01.544788 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
drop view if exists "football_db"."analytics"."stg_teams__dbt_backup" cascade
[0m00:31:01.545702 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
drop view if exists "football_db"."analytics"."stg_competitions__dbt_backup" cascade
[0m00:31:01.546328 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:31:01.546942 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
drop view if exists "football_db"."analytics"."stg_matches__dbt_backup" cascade
[0m00:31:01.550909 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m00:31:01.551645 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m00:31:01.552347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m00:31:01.555823 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m00:31:01.559541 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m00:31:01.560335 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709cf6d370>]}
[0m00:31:01.563075 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m00:31:01.566494 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m00:31:01.567542 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709cf6cc80>]}
[0m00:31:01.569155 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics.stg_players ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m00:31:01.570812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709c22ac00>]}
[0m00:31:01.572065 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8684a9da-9147-41b4-9158-2aebf0edd1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709c2671d0>]}
[0m00:31:01.573542 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics.stg_teams ........................... [[32mCREATE VIEW[0m in 0.35s]
[0m00:31:01.575009 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m00:31:01.576671 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_competitions .................... [[32mCREATE VIEW[0m in 0.36s]
[0m00:31:01.578448 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_matches ......................... [[32mCREATE VIEW[0m in 0.36s]
[0m00:31:01.580060 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m00:31:01.583843 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m00:31:01.585946 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m00:31:01.590976 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:01.592067 [debug] [MainThread]: On master: BEGIN
[0m00:31:01.592912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:01.607140 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m00:31:01.608515 [debug] [MainThread]: On master: COMMIT
[0m00:31:01.609859 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:01.610545 [debug] [MainThread]: On master: COMMIT
[0m00:31:01.612116 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:31:01.613960 [debug] [MainThread]: On master: Close
[0m00:31:01.615550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:01.616342 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m00:31:01.616915 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m00:31:01.617398 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m00:31:01.617886 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m00:31:01.618833 [info ] [MainThread]: 
[0m00:31:01.619891 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m00:31:01.624962 [debug] [MainThread]: Command end result
[0m00:31:01.669104 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:31:01.671751 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:31:01.681859 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:31:01.682534 [info ] [MainThread]: 
[0m00:31:01.683362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:01.684129 [info ] [MainThread]: 
[0m00:31:01.684970 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:31:01.687404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7938967, "process_in_blocks": "0", "process_kernel_time": 0.994507, "process_mem_max_rss": "113088", "process_out_blocks": "4352", "process_user_time": 4.350491}
[0m00:31:01.688412 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:01.688238 after 2.80 seconds
[0m00:31:01.689082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370a18b2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370a0dc91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73709c08e5d0>]}
[0m00:31:01.690550 [debug] [MainThread]: Flushing usage events
[0m00:31:04.006452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:56:47.624711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b3a39700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b3232e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b3a38380>]}


============================== 03:56:47.641772 | ecdff43b-1716-42ae-8dc4-f3fe1d750927 ==============================
[0m03:56:47.641772 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:56:47.642723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:56:48.080864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b3003bc0>]}
[0m03:56:48.211918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b2cc7e30>]}
[0m03:56:48.231000 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:56:48.399885 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:56:48.654297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:56:48.655104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:56:48.716980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b15147a0>]}
[0m03:56:48.852544 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:56:48.859856 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:56:48.937623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b120d160>]}
[0m03:56:48.938440 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m03:56:48.938983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b11da510>]}
[0m03:56:48.942857 [info ] [MainThread]: 
[0m03:56:48.943722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:56:48.944368 [info ] [MainThread]: 
[0m03:56:48.946370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:56:48.956567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m03:56:49.074642 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m03:56:49.075287 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m03:56:49.075681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:49.114588 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.039 seconds
[0m03:56:49.116475 [debug] [ThreadPool]: On list_football_db: Close
[0m03:56:49.117643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m03:56:49.118346 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m03:56:49.126033 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m03:56:49.126940 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m03:56:49.127463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:49.137985 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m03:56:49.138614 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m03:56:49.139072 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m03:56:49.140292 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m03:56:49.141765 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m03:56:49.142276 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m03:56:49.142730 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m03:56:49.163115 [debug] [ThreadPool]: SQL status: COMMIT in 0.020 seconds
[0m03:56:49.163846 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m03:56:49.166747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m03:56:49.173883 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m03:56:49.174581 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m03:56:49.174953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:49.184403 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m03:56:49.184884 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m03:56:49.185411 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m03:56:49.191177 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m03:56:49.193179 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m03:56:49.194086 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m03:56:49.201669 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:49.202536 [debug] [MainThread]: On master: BEGIN
[0m03:56:49.203075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:49.212624 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m03:56:49.213239 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:49.213725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:56:49.219776 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m03:56:49.221720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b14cfa70>]}
[0m03:56:49.222484 [debug] [MainThread]: On master: ROLLBACK
[0m03:56:49.223310 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:49.223773 [debug] [MainThread]: On master: BEGIN
[0m03:56:49.224891 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:56:49.225463 [debug] [MainThread]: On master: COMMIT
[0m03:56:49.225946 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:49.226562 [debug] [MainThread]: On master: COMMIT
[0m03:56:49.227428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:56:49.227887 [debug] [MainThread]: On master: Close
[0m03:56:49.233157 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m03:56:49.234283 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m03:56:49.235750 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m03:56:49.236804 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m03:56:49.235011 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m03:56:49.238090 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m03:56:49.239467 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m03:56:49.240670 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m03:56:49.241740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m03:56:49.242826 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m03:56:49.243946 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m03:56:49.245138 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m03:56:49.246298 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m03:56:49.247171 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m03:56:49.247875 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m03:56:49.248682 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m03:56:49.260718 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m03:56:49.266383 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m03:56:49.272554 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m03:56:49.278107 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m03:56:49.280964 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m03:56:49.281781 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m03:56:49.288344 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m03:56:49.318012 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m03:56:49.381940 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m03:56:49.385982 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m03:56:49.387170 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m03:56:49.393630 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m03:56:49.396145 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m03:56:49.397350 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m03:56:49.398349 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m03:56:49.399363 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m03:56:49.400328 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m03:56:49.401303 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m03:56:49.402189 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m03:56:49.403128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:49.403956 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:56:49.404746 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m03:56:49.405520 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:56:49.407240 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:56:49.419558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m03:56:49.420798 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m03:56:49.421609 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m03:56:49.422432 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    with competitions_sources as (select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions")

select * from competitions_sources
  );
[0m03:56:49.424242 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m03:56:49.425792 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m03:56:49.426616 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m03:56:49.427699 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    with players_sources as (select 
    players.id,
    players.name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on players.current_team = team.id)

select * from players_sources
  );
[0m03:56:49.428907 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m03:56:49.429889 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m03:56:49.431310 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    with teams_sources as (select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams")

select * from teams_sources
  );
[0m03:56:49.432596 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with matches_sources as (
    select 
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team -> 'name'):: TEXT as home_team,
        (away_team -> 'name'):: TEXT as away_team,
        (home_team -> 'tla'):: TEXT as home_team_code,
        (away_team -> 'tla'):: TEXT as away_team_code,
        (score -> 'winner'):: TEXT as result,
        (score -> 'fullTime' ->> 'home')::INT as home_final_score,
        (score -> 'fullTime' ->> 'away')::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from matches_sources
  );
[0m03:56:49.433752 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m03:56:49.441500 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m03:56:49.442635 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m03:56:49.443541 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m03:56:49.451451 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m03:56:49.458115 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m03:56:49.464049 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m03:56:49.469357 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m03:56:49.470328 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
alter table "football_db"."analytics"."stg_competitions__dbt_tmp" rename to "stg_competitions"
[0m03:56:49.471092 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
alter table "football_db"."analytics"."stg_matches__dbt_tmp" rename to "stg_matches"
[0m03:56:49.471867 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
alter table "football_db"."analytics"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m03:56:49.472585 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
alter table "football_db"."analytics"."stg_players__dbt_tmp" rename to "stg_players"
[0m03:56:49.474358 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:56:49.475277 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:56:49.475986 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:56:49.476701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m03:56:49.532181 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m03:56:49.536507 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m03:56:49.531667 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m03:56:49.539638 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m03:56:49.540350 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m03:56:49.540919 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m03:56:49.541482 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m03:56:49.542114 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m03:56:49.542887 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m03:56:49.543506 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m03:56:49.544084 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m03:56:49.544640 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m03:56:49.565845 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m03:56:49.576768 [debug] [Thread-2 (]: Applying DROP to: "football_db"."analytics"."stg_matches__dbt_backup"
[0m03:56:49.577811 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m03:56:49.578521 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m03:56:49.579122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m03:56:49.592937 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m03:56:49.596789 [debug] [Thread-4 (]: Applying DROP to: "football_db"."analytics"."stg_teams__dbt_backup"
[0m03:56:49.600331 [debug] [Thread-3 (]: Applying DROP to: "football_db"."analytics"."stg_players__dbt_backup"
[0m03:56:49.603199 [debug] [Thread-1 (]: Applying DROP to: "football_db"."analytics"."stg_competitions__dbt_backup"
[0m03:56:49.603908 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
drop view if exists "football_db"."analytics"."stg_matches__dbt_backup" cascade
[0m03:56:49.605259 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m03:56:49.606207 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m03:56:49.607119 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m03:56:49.607935 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
drop view if exists "football_db"."analytics"."stg_teams__dbt_backup" cascade
[0m03:56:49.608510 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
drop view if exists "football_db"."analytics"."stg_players__dbt_backup" cascade
[0m03:56:49.609034 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:56:49.609602 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
drop view if exists "football_db"."analytics"."stg_competitions__dbt_backup" cascade
[0m03:56:49.614256 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m03:56:49.615126 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m03:56:49.615693 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m03:56:49.618998 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m03:56:49.621269 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m03:56:49.623209 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m03:56:49.624828 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m03:56:49.639328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b4c5e210>]}
[0m03:56:49.640036 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b0273020>]}
[0m03:56:49.640924 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_matches ......................... [[32mCREATE VIEW[0m in 0.37s]
[0m03:56:49.642118 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b02605c0>]}
[0m03:56:49.643590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecdff43b-1716-42ae-8dc4-f3fe1d750927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b02723c0>]}
[0m03:56:49.643069 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics.stg_players ......................... [[32mCREATE VIEW[0m in 0.38s]
[0m03:56:49.644948 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m03:56:49.646025 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics.stg_teams ........................... [[32mCREATE VIEW[0m in 0.38s]
[0m03:56:49.647079 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_competitions .................... [[32mCREATE VIEW[0m in 0.39s]
[0m03:56:49.648080 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m03:56:49.649415 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m03:56:49.650449 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m03:56:49.654820 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:49.655573 [debug] [MainThread]: On master: BEGIN
[0m03:56:49.656033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:56:49.666371 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m03:56:49.667281 [debug] [MainThread]: On master: COMMIT
[0m03:56:49.668114 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:49.668808 [debug] [MainThread]: On master: COMMIT
[0m03:56:49.669857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:56:49.670435 [debug] [MainThread]: On master: Close
[0m03:56:49.671209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:49.671705 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m03:56:49.672099 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m03:56:49.672536 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m03:56:49.672901 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m03:56:49.673766 [info ] [MainThread]: 
[0m03:56:49.674511 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m03:56:49.678069 [debug] [MainThread]: Command end result
[0m03:56:49.713269 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:56:49.716082 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:56:49.724560 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m03:56:49.725115 [info ] [MainThread]: 
[0m03:56:49.725777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:56:49.726489 [info ] [MainThread]: 
[0m03:56:49.727548 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m03:56:49.736214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.232686, "process_in_blocks": "111768", "process_kernel_time": 1.132655, "process_mem_max_rss": "108788", "process_out_blocks": "3504", "process_user_time": 3.494021}
[0m03:56:49.737692 [debug] [MainThread]: Command `dbt run` succeeded at 03:56:49.737374 after 2.23 seconds
[0m03:56:49.738451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b3232e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b0248080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5b38646e0>]}
[0m03:56:49.739207 [debug] [MainThread]: Flushing usage events
[0m03:56:52.687001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:31:13.013630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e7927740b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e793000bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e792774200>]}


============================== 04:31:13.030517 | e3e1a301-b915-483b-a1e2-948d54dfb1e5 ==============================
[0m04:31:13.030517 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:31:13.032118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:31:13.351429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e792705610>]}
[0m04:31:13.448607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e7926bb110>]}
[0m04:31:13.450479 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:31:13.624328 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:31:13.794166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:31:13.795123 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_matches.sql
[0m04:31:14.187884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e790eab350>]}
[0m04:31:14.286604 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:31:14.290573 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:31:14.333665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e7900f4860>]}
[0m04:31:14.334402 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m04:31:14.334940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e792705880>]}
[0m04:31:14.338152 [info ] [MainThread]: 
[0m04:31:14.338807 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:31:14.339782 [info ] [MainThread]: 
[0m04:31:14.342064 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:31:14.351941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m04:31:14.474585 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m04:31:14.475213 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m04:31:14.475595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:14.513560 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m04:31:14.516034 [debug] [ThreadPool]: On list_football_db: Close
[0m04:31:14.517289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m04:31:14.518158 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m04:31:14.524791 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m04:31:14.525269 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m04:31:14.525632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:31:14.535679 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m04:31:14.536103 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m04:31:14.536462 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m04:31:14.537461 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m04:31:14.539000 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m04:31:14.539417 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m04:31:14.539773 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m04:31:14.565625 [debug] [ThreadPool]: SQL status: COMMIT in 0.025 seconds
[0m04:31:14.566654 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m04:31:14.569543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m04:31:14.580952 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m04:31:14.581638 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m04:31:14.582075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:31:14.592146 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m04:31:14.592706 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m04:31:14.593311 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m04:31:14.599585 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m04:31:14.601398 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m04:31:14.602280 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m04:31:14.611162 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:14.612090 [debug] [MainThread]: On master: BEGIN
[0m04:31:14.612566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:14.624186 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m04:31:14.624932 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:14.625421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:31:14.631873 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m04:31:14.634468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e790bc6ab0>]}
[0m04:31:14.635321 [debug] [MainThread]: On master: ROLLBACK
[0m04:31:14.636397 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:14.636949 [debug] [MainThread]: On master: BEGIN
[0m04:31:14.638281 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:31:14.639056 [debug] [MainThread]: On master: COMMIT
[0m04:31:14.640143 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:14.641025 [debug] [MainThread]: On master: COMMIT
[0m04:31:14.642063 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:31:14.642581 [debug] [MainThread]: On master: Close
[0m04:31:14.648726 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m04:31:14.649478 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m04:31:14.650413 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m04:31:14.651869 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m04:31:14.651308 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m04:31:14.653028 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m04:31:14.654295 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m04:31:14.655491 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m04:31:14.656792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m04:31:14.657830 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m04:31:14.658928 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m04:31:14.660177 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m04:31:14.660909 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m04:31:14.661677 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m04:31:14.662390 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m04:31:14.663025 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m04:31:14.675516 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m04:31:14.681800 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m04:31:14.686909 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m04:31:14.691071 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m04:31:14.693501 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m04:31:14.694846 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m04:31:14.708928 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m04:31:14.709662 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m04:31:14.780897 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m04:31:14.783135 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m04:31:14.779235 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m04:31:14.788854 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m04:31:14.791175 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m04:31:14.791980 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:31:14.792724 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:31:14.793352 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m04:31:14.793988 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m04:31:14.794526 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:31:14.795136 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m04:31:14.795656 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:31:14.796236 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:31:14.796793 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m04:31:14.797290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.798931 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:31:14.809453 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m04:31:14.810330 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m04:31:14.811796 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:31:14.812584 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m04:31:14.813277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m04:31:14.813840 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m04:31:14.814563 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    with teams_sources as (select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams")

select * from teams_sources
  );
[0m04:31:14.815300 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:31:14.815946 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:31:14.816786 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with matches_sources as (
    select 
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        home_team -> 'name' as home_team,
        away_team -> 'name' as away_team,
        home_team -> 'tla' as home_team_code,
        away_team -> 'tla' as away_team_code,
        score -> 'winner' as result,
        (score -> 'fullTime' ->> 'home')::INT as home_final_score,
        (score -> 'fullTime' ->> 'away')::INT as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from matches_sources
  );
[0m04:31:14.818099 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    with players_sources as (select 
    players.id,
    players.name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on players.current_team = team.id)

select * from players_sources
  );
[0m04:31:14.818983 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    with competitions_sources as (select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions")

select * from competitions_sources
  );
[0m04:31:14.822591 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m04:31:14.829453 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m04:31:14.834370 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:31:14.835298 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m04:31:14.836055 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m04:31:14.840390 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:31:14.841135 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
alter table "football_db"."analytics"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m04:31:14.847283 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:31:14.852081 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m04:31:14.852843 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
alter table "football_db"."analytics"."stg_players__dbt_tmp" rename to "stg_players"
[0m04:31:14.853751 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
alter table "football_db"."analytics"."stg_competitions__dbt_tmp" rename to "stg_competitions"
[0m04:31:14.854641 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
alter table "football_db"."analytics"."stg_matches__dbt_tmp" rename to "stg_matches"
[0m04:31:14.855568 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:31:14.867878 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m04:31:14.868896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m04:31:14.869416 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m04:31:14.878948 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m04:31:14.881246 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m04:31:14.883559 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m04:31:14.885165 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m04:31:14.885975 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:31:14.886982 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:31:14.887833 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:31:14.888737 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m04:31:14.889633 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m04:31:14.890552 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m04:31:14.891441 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m04:31:14.892340 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m04:31:14.918344 [debug] [Thread-4 (]: SQL status: COMMIT in 0.025 seconds
[0m04:31:14.927264 [debug] [Thread-4 (]: Applying DROP to: "football_db"."analytics"."stg_teams__dbt_backup"
[0m04:31:14.928395 [debug] [Thread-3 (]: SQL status: COMMIT in 0.035 seconds
[0m04:31:14.929205 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m04:31:14.929700 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m04:31:14.938320 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:31:14.942194 [debug] [Thread-3 (]: Applying DROP to: "football_db"."analytics"."stg_players__dbt_backup"
[0m04:31:14.945275 [debug] [Thread-1 (]: Applying DROP to: "football_db"."analytics"."stg_competitions__dbt_backup"
[0m04:31:14.948525 [debug] [Thread-2 (]: Applying DROP to: "football_db"."analytics"."stg_matches__dbt_backup"
[0m04:31:14.949464 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
drop view if exists "football_db"."analytics"."stg_teams__dbt_backup" cascade
[0m04:31:14.950708 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:31:14.951565 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:31:14.952455 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m04:31:14.953223 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
drop view if exists "football_db"."analytics"."stg_players__dbt_backup" cascade
[0m04:31:14.954074 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m04:31:14.954598 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
drop view if exists "football_db"."analytics"."stg_competitions__dbt_backup" cascade
[0m04:31:14.955160 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
drop view if exists "football_db"."analytics"."stg_matches__dbt_backup" cascade
[0m04:31:14.958679 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m04:31:14.959385 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m04:31:14.961705 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m04:31:14.964447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m04:31:14.965527 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m04:31:14.966774 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e7901c80e0>]}
[0m04:31:14.968462 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m04:31:14.968836 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e7801226f0>]}
[0m04:31:14.970980 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m04:31:14.971952 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics.stg_teams ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m04:31:14.974095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e781ae1b20>]}
[0m04:31:14.973193 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics.stg_players ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m04:31:14.975765 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m04:31:14.976447 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e1a301-b915-483b-a1e2-948d54dfb1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e7801216d0>]}
[0m04:31:14.977847 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_competitions .................... [[32mCREATE VIEW[0m in 0.32s]
[0m04:31:14.979186 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m04:31:14.981002 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_matches ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m04:31:14.982426 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m04:31:14.983878 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m04:31:14.988034 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:14.988687 [debug] [MainThread]: On master: BEGIN
[0m04:31:14.989121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:31:14.998655 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m04:31:14.999254 [debug] [MainThread]: On master: COMMIT
[0m04:31:14.999669 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:15.001229 [debug] [MainThread]: On master: COMMIT
[0m04:31:15.002846 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:31:15.003864 [debug] [MainThread]: On master: Close
[0m04:31:15.004797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:15.005576 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m04:31:15.006177 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m04:31:15.006692 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m04:31:15.007277 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m04:31:15.008077 [info ] [MainThread]: 
[0m04:31:15.008798 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m04:31:15.011515 [debug] [MainThread]: Command end result
[0m04:31:15.052218 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:31:15.055604 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:31:15.063780 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:31:15.064241 [info ] [MainThread]: 
[0m04:31:15.064779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:15.065302 [info ] [MainThread]: 
[0m04:31:15.066641 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:31:15.068580 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1247656, "process_in_blocks": "480", "process_kernel_time": 1.186788, "process_mem_max_rss": "113180", "process_out_blocks": "4352", "process_user_time": 3.50385}
[0m04:31:15.069316 [debug] [MainThread]: Command `dbt run` succeeded at 04:31:15.069162 after 2.13 seconds
[0m04:31:15.069988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e79337b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e790162000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e781aca660>]}
[0m04:31:15.070889 [debug] [MainThread]: Flushing usage events
[0m04:31:17.415542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:38:45.390201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d26bb260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d26ba960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d26b8830>]}


============================== 04:38:45.403792 | 63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b ==============================
[0m04:38:45.403792 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:38:45.406461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:38:45.718294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d20be060>]}
[0m04:38:45.803771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d2338c80>]}
[0m04:38:45.804995 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:38:45.961593 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:38:46.143410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:38:46.144727 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_matches.sql
[0m04:38:46.532689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d03756a0>]}
[0m04:38:46.647433 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:38:46.666367 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:38:46.710422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9ce25c9e0>]}
[0m04:38:46.711244 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m04:38:46.711859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9ce2b9d30>]}
[0m04:38:46.715268 [info ] [MainThread]: 
[0m04:38:46.716021 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:38:46.717432 [info ] [MainThread]: 
[0m04:38:46.719296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:38:46.728223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m04:38:46.817323 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m04:38:46.817858 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m04:38:46.818267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:38:46.833720 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m04:38:46.835470 [debug] [ThreadPool]: On list_football_db: Close
[0m04:38:46.836557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m04:38:46.837168 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m04:38:46.843443 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m04:38:46.844128 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m04:38:46.844566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:38:46.853380 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m04:38:46.853998 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m04:38:46.854554 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m04:38:46.856003 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m04:38:46.857717 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m04:38:46.858188 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m04:38:46.858669 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m04:38:46.866119 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m04:38:46.866947 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m04:38:46.870798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m04:38:46.884101 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m04:38:46.884852 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m04:38:46.885224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:38:46.944754 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m04:38:46.945290 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m04:38:46.945913 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m04:38:46.951729 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m04:38:46.953782 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m04:38:46.954671 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m04:38:46.963996 [debug] [MainThread]: Using postgres connection "master"
[0m04:38:46.964658 [debug] [MainThread]: On master: BEGIN
[0m04:38:46.965583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:38:46.978592 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m04:38:46.979361 [debug] [MainThread]: Using postgres connection "master"
[0m04:38:46.980417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:38:46.988708 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m04:38:46.991000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d20bc3e0>]}
[0m04:38:46.991766 [debug] [MainThread]: On master: ROLLBACK
[0m04:38:46.992820 [debug] [MainThread]: Using postgres connection "master"
[0m04:38:46.993300 [debug] [MainThread]: On master: BEGIN
[0m04:38:46.994513 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:38:46.995280 [debug] [MainThread]: On master: COMMIT
[0m04:38:46.995930 [debug] [MainThread]: Using postgres connection "master"
[0m04:38:46.996775 [debug] [MainThread]: On master: COMMIT
[0m04:38:46.997934 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:38:46.998382 [debug] [MainThread]: On master: Close
[0m04:38:47.005235 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m04:38:47.006690 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m04:38:47.007488 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m04:38:47.008005 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m04:38:47.008915 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m04:38:47.009929 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m04:38:47.010996 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m04:38:47.012111 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m04:38:47.013311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m04:38:47.014297 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m04:38:47.015335 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m04:38:47.016406 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m04:38:47.017362 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m04:38:47.018095 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m04:38:47.018879 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m04:38:47.019918 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m04:38:47.031141 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m04:38:47.035734 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m04:38:47.040108 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m04:38:47.044058 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m04:38:47.046056 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m04:38:47.047092 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m04:38:47.047934 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m04:38:47.096314 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m04:38:47.119115 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m04:38:47.121191 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m04:38:47.118343 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m04:38:47.126999 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m04:38:47.129652 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:38:47.130807 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m04:38:47.131452 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:38:47.131997 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m04:38:47.132662 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:38:47.133213 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m04:38:47.133773 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m04:38:47.134342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:47.134867 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m04:38:47.135370 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:38:47.135864 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:38:47.136845 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:38:47.145646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m04:38:47.146604 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:38:47.147573 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m04:38:47.148390 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    with competitions_sources as (select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions")

select * from competitions_sources
  );
[0m04:38:47.149049 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m04:38:47.149735 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:38:47.150601 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:38:47.151492 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    with players_sources as (select 
    players.id,
    players.name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on players.current_team = team.id)

select * from players_sources
  );
[0m04:38:47.152215 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    with teams_sources as (select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams")

select * from teams_sources
  );
[0m04:38:47.155992 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m04:38:47.156759 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m04:38:47.157243 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m04:38:47.167857 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:38:47.173217 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:38:47.173993 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m04:38:47.180133 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:38:47.180856 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
alter table "football_db"."analytics"."stg_competitions__dbt_tmp" rename to "stg_competitions"
[0m04:38:47.181516 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
alter table "football_db"."analytics"."stg_players__dbt_tmp" rename to "stg_players"
[0m04:38:47.182332 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m04:38:47.183064 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
alter table "football_db"."analytics"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m04:38:47.184205 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with matches_sources as (
    select
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        (home_team::jsonb ->> 'name') as home_team,
        (away_team::jsonb ->> 'name') as away_team,
        (home_team::jsonb ->> 'tla')  as home_team_code,
        (away_team::jsonb ->> 'tla')  as away_team_code,
        score::jsonb ->> 'winner' as result,
        (score::jsonb -> 'fullTime' ->> 'home')::int as home_final_score,
        (score::jsonb -> 'fullTime' ->> 'away')::int as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches";

)

select * from matches_sources
  );
[0m04:38:47.185065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:38:47.185621 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:38:47.197755 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m04:38:47.208179 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27:     from "football_db"."raw"."matches";
                                               ^

[0m04:38:47.225736 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m04:38:47.232041 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m04:38:47.236079 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m04:38:47.237130 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: ROLLBACK
[0m04:38:47.238178 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:38:47.239088 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:38:47.239781 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:38:47.240782 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m04:38:47.241826 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m04:38:47.242588 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m04:38:47.243514 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m04:38:47.263818 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m04:38:47.265135 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m04:38:47.265693 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m04:38:47.276109 [debug] [Thread-1 (]: Applying DROP to: "football_db"."analytics"."stg_competitions__dbt_backup"
[0m04:38:47.280223 [debug] [Thread-3 (]: Applying DROP to: "football_db"."analytics"."stg_players__dbt_backup"
[0m04:38:47.284132 [debug] [Thread-4 (]: Applying DROP to: "football_db"."analytics"."stg_teams__dbt_backup"
[0m04:38:47.294940 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m04:38:47.296828 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m04:38:47.298248 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m04:38:47.299164 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
drop view if exists "football_db"."analytics"."stg_competitions__dbt_backup" cascade
[0m04:38:47.300000 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
drop view if exists "football_db"."analytics"."stg_players__dbt_backup" cascade
[0m04:38:47.301122 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
drop view if exists "football_db"."analytics"."stg_teams__dbt_backup" cascade
[0m04:38:47.302944 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m04:38:47.303603 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m04:38:47.308499 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m04:38:47.309488 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m04:38:47.311816 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m04:38:47.318395 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m04:38:47.318950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d3faeb10>]}
[0m04:38:47.321190 [debug] [Thread-2 (]: Database Error in model stg_matches (models/staging/stg_matches.sql)
  syntax error at or near ";"
  LINE 27:     from "football_db"."raw"."matches";
                                                 ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m04:38:47.322297 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9ce3297c0>]}
[0m04:38:47.323031 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9cd55c5f0>]}
[0m04:38:47.324028 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_competitions .................... [[32mCREATE VIEW[0m in 0.30s]
[0m04:38:47.324948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fdd4ac-6c11-4bc7-a70f-cdfd7353d69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9cd4edd30>]}
[0m04:38:47.326149 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics.stg_players ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m04:38:47.327421 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics.stg_teams ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m04:38:47.328804 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m04:38:47.329857 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics.stg_matches ..................... [[31mERROR[0m in 0.31s]
[0m04:38:47.331144 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m04:38:47.332275 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m04:38:47.333995 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m04:38:47.335910 [debug] [Thread-7 (]: Marking all children of 'model.football_dbt.stg_matches' to be skipped because of status 'error'.  Reason: Database Error in model stg_matches (models/staging/stg_matches.sql)
  syntax error at or near ";"
  LINE 27:     from "football_db"."raw"."matches";
                                                 ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql.
[0m04:38:47.340297 [debug] [MainThread]: Using postgres connection "master"
[0m04:38:47.341154 [debug] [MainThread]: On master: BEGIN
[0m04:38:47.341626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:38:47.353410 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m04:38:47.354734 [debug] [MainThread]: On master: COMMIT
[0m04:38:47.355583 [debug] [MainThread]: Using postgres connection "master"
[0m04:38:47.356227 [debug] [MainThread]: On master: COMMIT
[0m04:38:47.357271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:38:47.358257 [debug] [MainThread]: On master: Close
[0m04:38:47.359107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:38:47.359757 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m04:38:47.360298 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m04:38:47.360914 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m04:38:47.361429 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m04:38:47.362195 [info ] [MainThread]: 
[0m04:38:47.362852 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m04:38:47.365989 [debug] [MainThread]: Command end result
[0m04:38:47.407773 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:38:47.410298 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:38:47.419121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:38:47.419674 [info ] [MainThread]: 
[0m04:38:47.420266 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m04:38:47.420939 [info ] [MainThread]: 
[0m04:38:47.421612 [error] [MainThread]:   Database Error in model stg_matches (models/staging/stg_matches.sql)
  syntax error at or near ";"
  LINE 27:     from "football_db"."raw"."matches";
                                                 ^
  compiled code at target/run/football_dbt/models/staging/stg_matches.sql
[0m04:38:47.422155 [info ] [MainThread]: 
[0m04:38:47.422975 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m04:38:47.424976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1078856, "process_in_blocks": "368", "process_kernel_time": 0.969031, "process_mem_max_rss": "113372", "process_out_blocks": "4352", "process_user_time": 3.450897}
[0m04:38:47.425744 [debug] [MainThread]: Command `dbt run` failed at 04:38:47.425591 after 2.11 seconds
[0m04:38:47.426289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d22eef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d212f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc9d0833620>]}
[0m04:38:47.426895 [debug] [MainThread]: Flushing usage events
[0m04:38:49.479533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:19:06.142701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70395d0a1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70395eac41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70395e4a7b00>]}


============================== 05:19:06.154879 | a3d5588c-801f-40e0-99d8-ca18171fa980 ==============================
[0m05:19:06.154879 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:19:06.156294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:19:06.538759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70395cc10170>]}
[0m05:19:06.628276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70395d1515b0>]}
[0m05:19:06.629522 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:19:06.801820 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:19:06.978890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:19:06.980253 [debug] [MainThread]: Partial parsing: updated file: football_dbt://models/staging/stg_matches.sql
[0m05:19:07.443774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703958d4dbb0>]}
[0m05:19:07.582670 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:19:07.587614 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:19:07.631329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703958cf0aa0>]}
[0m05:19:07.632169 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m05:19:07.632828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703958d4db80>]}
[0m05:19:07.637092 [info ] [MainThread]: 
[0m05:19:07.637875 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:19:07.638621 [info ] [MainThread]: 
[0m05:19:07.639934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:19:07.649577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_football_db'
[0m05:19:07.736770 [debug] [ThreadPool]: Using postgres connection "list_football_db"
[0m05:19:07.737511 [debug] [ThreadPool]: On list_football_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db"} */

    select distinct nspname from pg_namespace
  
[0m05:19:07.737947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:19:07.773862 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m05:19:07.776232 [debug] [ThreadPool]: On list_football_db: Close
[0m05:19:07.777459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_football_db, now create_football_db_analytics)
[0m05:19:07.778146 [debug] [ThreadPool]: Creating schema "database: "football_db"
schema: "analytics"
"
[0m05:19:07.785933 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m05:19:07.786512 [debug] [ThreadPool]: On create_football_db_analytics: BEGIN
[0m05:19:07.787060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:19:07.797271 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m05:19:07.797923 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m05:19:07.798449 [debug] [ThreadPool]: On create_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "create_football_db_analytics"} */
create schema if not exists "analytics"
[0m05:19:07.799933 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m05:19:07.801477 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m05:19:07.801992 [debug] [ThreadPool]: Using postgres connection "create_football_db_analytics"
[0m05:19:07.802466 [debug] [ThreadPool]: On create_football_db_analytics: COMMIT
[0m05:19:07.804642 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m05:19:07.805190 [debug] [ThreadPool]: On create_football_db_analytics: Close
[0m05:19:07.808875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_football_db_analytics, now list_football_db_analytics)
[0m05:19:07.818754 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m05:19:07.819441 [debug] [ThreadPool]: On list_football_db_analytics: BEGIN
[0m05:19:07.819927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:19:07.829915 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m05:19:07.830828 [debug] [ThreadPool]: Using postgres connection "list_football_db_analytics"
[0m05:19:07.831640 [debug] [ThreadPool]: On list_football_db_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "list_football_db_analytics"} */
select
      'football_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'football_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m05:19:07.838434 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m05:19:07.841046 [debug] [ThreadPool]: On list_football_db_analytics: ROLLBACK
[0m05:19:07.841966 [debug] [ThreadPool]: On list_football_db_analytics: Close
[0m05:19:07.849657 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:07.850373 [debug] [MainThread]: On master: BEGIN
[0m05:19:07.851027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:19:07.861109 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m05:19:07.861795 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:07.862663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:19:07.869327 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m05:19:07.871336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70395e8f85f0>]}
[0m05:19:07.872342 [debug] [MainThread]: On master: ROLLBACK
[0m05:19:07.873336 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:07.873748 [debug] [MainThread]: On master: BEGIN
[0m05:19:07.874814 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:19:07.875303 [debug] [MainThread]: On master: COMMIT
[0m05:19:07.876102 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:07.876670 [debug] [MainThread]: On master: COMMIT
[0m05:19:07.877979 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:19:07.878701 [debug] [MainThread]: On master: Close
[0m05:19:07.884941 [debug] [Thread-1 (]: Began running node model.football_dbt.stg_competitions
[0m05:19:07.885878 [debug] [Thread-2 (]: Began running node model.football_dbt.stg_matches
[0m05:19:07.886629 [debug] [Thread-3 (]: Began running node model.football_dbt.stg_players
[0m05:19:07.887984 [debug] [Thread-4 (]: Began running node model.football_dbt.stg_teams
[0m05:19:07.887374 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_competitions ......................... [RUN]
[0m05:19:07.889155 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_matches .............................. [RUN]
[0m05:19:07.890357 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics.stg_players .............................. [RUN]
[0m05:19:07.891443 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.stg_teams ................................ [RUN]
[0m05:19:07.892780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_football_db_analytics, now model.football_dbt.stg_competitions)
[0m05:19:07.894085 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.football_dbt.stg_matches'
[0m05:19:07.895460 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.football_dbt.stg_players'
[0m05:19:07.896640 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.football_dbt.stg_teams'
[0m05:19:07.897549 [debug] [Thread-1 (]: Began compiling node model.football_dbt.stg_competitions
[0m05:19:07.898199 [debug] [Thread-2 (]: Began compiling node model.football_dbt.stg_matches
[0m05:19:07.898778 [debug] [Thread-3 (]: Began compiling node model.football_dbt.stg_players
[0m05:19:07.899606 [debug] [Thread-4 (]: Began compiling node model.football_dbt.stg_teams
[0m05:19:07.911899 [debug] [Thread-1 (]: Writing injected SQL for node "model.football_dbt.stg_competitions"
[0m05:19:07.916834 [debug] [Thread-2 (]: Writing injected SQL for node "model.football_dbt.stg_matches"
[0m05:19:07.921443 [debug] [Thread-3 (]: Writing injected SQL for node "model.football_dbt.stg_players"
[0m05:19:07.925486 [debug] [Thread-4 (]: Writing injected SQL for node "model.football_dbt.stg_teams"
[0m05:19:07.927414 [debug] [Thread-2 (]: Began executing node model.football_dbt.stg_matches
[0m05:19:07.928029 [debug] [Thread-1 (]: Began executing node model.football_dbt.stg_competitions
[0m05:19:07.956104 [debug] [Thread-4 (]: Began executing node model.football_dbt.stg_teams
[0m05:19:07.985449 [debug] [Thread-3 (]: Began executing node model.football_dbt.stg_players
[0m05:19:08.005540 [debug] [Thread-1 (]: Writing runtime sql for node "model.football_dbt.stg_competitions"
[0m05:19:08.006535 [debug] [Thread-2 (]: Writing runtime sql for node "model.football_dbt.stg_matches"
[0m05:19:08.011444 [debug] [Thread-4 (]: Writing runtime sql for node "model.football_dbt.stg_teams"
[0m05:19:08.019014 [debug] [Thread-3 (]: Writing runtime sql for node "model.football_dbt.stg_players"
[0m05:19:08.021059 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m05:19:08.022568 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m05:19:08.023283 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m05:19:08.023993 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m05:19:08.024474 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: BEGIN
[0m05:19:08.025040 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: BEGIN
[0m05:19:08.025592 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: BEGIN
[0m05:19:08.026137 [debug] [Thread-3 (]: On model.football_dbt.stg_players: BEGIN
[0m05:19:08.026757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:08.027443 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:19:08.027991 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m05:19:08.028516 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:19:08.039211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m05:19:08.040452 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m05:19:08.041233 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m05:19:08.042112 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m05:19:08.042853 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m05:19:08.043469 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m05:19:08.044260 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */

  create view "football_db"."analytics"."stg_competitions__dbt_tmp"
    
    
  as (
    with competitions_sources as (select 
    id,
    name,
    code,
    type,
    plan,
    area_id,
    area_name,
    season_id,
    season_start,
    season_end,
    emblem,
    (raw_payload -> 'currentSeason' ->> 'currentMatchday'):: INT as current_matchday,
    (raw_payload -> 'numberOfAvailableSeasons'):: INT as number_available_seasons,
    last_updated,
    inserted_at
from "football_db"."raw"."competitions")

select * from competitions_sources
  );
[0m05:19:08.044904 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m05:19:08.045772 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */

  create view "football_db"."analytics"."stg_teams__dbt_tmp"
    
    
  as (
    with teams_sources as (select 
    id,
    comp_id,
    name as team_name,
    code as team_code,
    flag,
    team_emblem,
    founded,
    venue,
    website,
    club_colors,
    address,
    last_updated,
    inserted_at
from "football_db"."raw"."teams")

select * from teams_sources
  );
[0m05:19:08.046623 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m05:19:08.047558 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */

  create view "football_db"."analytics"."stg_matches__dbt_tmp"
    
    
  as (
    with matches_sources as (
    select
        id,
        date,
        area_id,
        competition_id,
        season_id,
        status,
        duration_status,
        stage,
        group_name,
        home_team::jsonb ->> 'name' as home_team,
        away_team::jsonb ->> 'name' as away_team,
        home_team::jsonb ->> 'tla'  as home_team_code,
        away_team::jsonb ->> 'tla'  as away_team_code,
        score::jsonb ->> 'winner' as result,
        (score::jsonb -> 'fullTime' ->> 'home')::int as home_final_score,
        (score::jsonb -> 'fullTime' ->> 'away')::int as away_final_score,
        last_updated,
        inserted_at
    from "football_db"."raw"."matches"
)

select * from matches_sources
  );
[0m05:19:08.048635 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */

  create view "football_db"."analytics"."stg_players__dbt_tmp"
    
    
  as (
    with players_sources as (select 
    players.id,
    players.name,
    players.date_of_birth,
    players.nationality,
    players.position,
    team.name as current_team,
    players.last_updated,
    players.inserted_at
from "football_db"."raw"."players" players
left join "football_db"."raw"."teams" team
on players.current_team = team.id)

select * from players_sources
  );
[0m05:19:08.053139 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m05:19:08.053905 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m05:19:08.054502 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m05:19:08.055005 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m05:19:08.064339 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m05:19:08.069637 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m05:19:08.073356 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m05:19:08.077469 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m05:19:08.078185 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
alter table "football_db"."analytics"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m05:19:08.079086 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
alter table "football_db"."analytics"."stg_players__dbt_tmp" rename to "stg_players"
[0m05:19:08.079786 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
alter table "football_db"."analytics"."stg_matches__dbt_tmp" rename to "stg_matches"
[0m05:19:08.080411 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
alter table "football_db"."analytics"."stg_competitions__dbt_tmp" rename to "stg_competitions"
[0m05:19:08.082108 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:19:08.083063 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:19:08.083543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:19:08.084170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:19:08.113822 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m05:19:08.114569 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m05:19:08.116891 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m05:19:08.118539 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m05:19:08.119166 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m05:19:08.119830 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m05:19:08.120627 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m05:19:08.121178 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m05:19:08.121833 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: COMMIT
[0m05:19:08.122376 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: COMMIT
[0m05:19:08.122911 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: COMMIT
[0m05:19:08.123612 [debug] [Thread-3 (]: On model.football_dbt.stg_players: COMMIT
[0m05:19:08.144426 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m05:19:08.151906 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m05:19:08.154745 [debug] [Thread-2 (]: Applying DROP to: "football_db"."analytics"."stg_matches__dbt_backup"
[0m05:19:08.155395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m05:19:08.156122 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m05:19:08.158758 [debug] [Thread-4 (]: Applying DROP to: "football_db"."analytics"."stg_teams__dbt_backup"
[0m05:19:08.167472 [debug] [Thread-2 (]: Using postgres connection "model.football_dbt.stg_matches"
[0m05:19:08.170900 [debug] [Thread-1 (]: Applying DROP to: "football_db"."analytics"."stg_competitions__dbt_backup"
[0m05:19:08.174360 [debug] [Thread-3 (]: Applying DROP to: "football_db"."analytics"."stg_players__dbt_backup"
[0m05:19:08.175654 [debug] [Thread-4 (]: Using postgres connection "model.football_dbt.stg_teams"
[0m05:19:08.176616 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_matches"} */
drop view if exists "football_db"."analytics"."stg_matches__dbt_backup" cascade
[0m05:19:08.177531 [debug] [Thread-1 (]: Using postgres connection "model.football_dbt.stg_competitions"
[0m05:19:08.178360 [debug] [Thread-3 (]: Using postgres connection "model.football_dbt.stg_players"
[0m05:19:08.178986 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_teams"} */
drop view if exists "football_db"."analytics"."stg_teams__dbt_backup" cascade
[0m05:19:08.179975 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_competitions"} */
drop view if exists "football_db"."analytics"."stg_competitions__dbt_backup" cascade
[0m05:19:08.180594 [debug] [Thread-3 (]: On model.football_dbt.stg_players: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "football_dbt", "target_name": "dev", "node_id": "model.football_dbt.stg_players"} */
drop view if exists "football_db"."analytics"."stg_players__dbt_backup" cascade
[0m05:19:08.181120 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m05:19:08.182254 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m05:19:08.186078 [debug] [Thread-2 (]: On model.football_dbt.stg_matches: Close
[0m05:19:08.186711 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m05:19:08.187355 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m05:19:08.189059 [debug] [Thread-4 (]: On model.football_dbt.stg_teams: Close
[0m05:19:08.191049 [debug] [Thread-1 (]: On model.football_dbt.stg_competitions: Close
[0m05:19:08.195259 [debug] [Thread-3 (]: On model.football_dbt.stg_players: Close
[0m05:19:08.196035 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70395ae42f30>]}
[0m05:19:08.197104 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703913fd3c50>]}
[0m05:19:08.197883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703913fd3d10>]}
[0m05:19:08.199111 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_matches ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m05:19:08.200024 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d5588c-801f-40e0-99d8-ca18171fa980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703958db9550>]}
[0m05:19:08.201242 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics.stg_teams ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m05:19:08.202551 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_competitions .................... [[32mCREATE VIEW[0m in 0.31s]
[0m05:19:08.203998 [debug] [Thread-2 (]: Finished running node model.football_dbt.stg_matches
[0m05:19:08.205039 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics.stg_players ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m05:19:08.206332 [debug] [Thread-4 (]: Finished running node model.football_dbt.stg_teams
[0m05:19:08.207288 [debug] [Thread-1 (]: Finished running node model.football_dbt.stg_competitions
[0m05:19:08.208834 [debug] [Thread-3 (]: Finished running node model.football_dbt.stg_players
[0m05:19:08.213329 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:08.214190 [debug] [MainThread]: On master: BEGIN
[0m05:19:08.214766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:19:08.226473 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:19:08.227229 [debug] [MainThread]: On master: COMMIT
[0m05:19:08.228067 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:08.228733 [debug] [MainThread]: On master: COMMIT
[0m05:19:08.229895 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:19:08.230469 [debug] [MainThread]: On master: Close
[0m05:19:08.231338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:19:08.231883 [debug] [MainThread]: Connection 'model.football_dbt.stg_competitions' was properly closed.
[0m05:19:08.232366 [debug] [MainThread]: Connection 'model.football_dbt.stg_matches' was properly closed.
[0m05:19:08.232873 [debug] [MainThread]: Connection 'model.football_dbt.stg_players' was properly closed.
[0m05:19:08.233359 [debug] [MainThread]: Connection 'model.football_dbt.stg_teams' was properly closed.
[0m05:19:08.233915 [info ] [MainThread]: 
[0m05:19:08.234556 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m05:19:08.237327 [debug] [MainThread]: Command end result
[0m05:19:08.279383 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:19:08.282294 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:19:08.292342 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:19:08.292906 [info ] [MainThread]: 
[0m05:19:08.293527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:19:08.294049 [info ] [MainThread]: 
[0m05:19:08.294949 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:19:08.297179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2337732, "process_in_blocks": "0", "process_kernel_time": 0.863393, "process_mem_max_rss": "112512", "process_out_blocks": "4352", "process_user_time": 3.746727}
[0m05:19:08.298702 [debug] [MainThread]: Command `dbt run` succeeded at 05:19:08.298349 after 2.24 seconds
[0m05:19:08.299271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70395d7f7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703910e26390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703910e27cb0>]}
[0m05:19:08.300035 [debug] [MainThread]: Flushing usage events
[0m05:19:11.028576 [debug] [MainThread]: An error was encountered while trying to flush usage events
